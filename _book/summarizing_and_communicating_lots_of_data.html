<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.433">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Statistics - 3&nbsp; Summarizing and communicating lots of data</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./from_limited_data_to_populations.html" rel="next">
<link href="./categorical_data_and_proportions.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating slimcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./summarizing_and_communicating_lots_of_data.html"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Summarizing and communicating lots of data</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Statistics</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./introduction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title"><strong>Introduction</strong></span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./categorical_data_and_proportions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Categorical Data and Proportions</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./summarizing_and_communicating_lots_of_data.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Summarizing and communicating lots of data</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./from_limited_data_to_populations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">From limited data to populations</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./what_causes_what.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">What causes what?</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./modelling_relationships_using_regression_part_1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Modelling relationships part 1: Some basic mathematical ideas</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./modelling_relationships_using_regression_part_2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Algorithmic prediction</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./how_sure_can_we_be.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">How sure can we be about what is going on</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./probability.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Probability: Quantifying uncertainty and variablility</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./probability_and_statistics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Putting probability and statistics together</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./answering_questions_and_claiming_discoveries.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Answering questions and claiming discoveries</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#understanding-variation-in-a-single-variable-using-histograms" id="toc-understanding-variation-in-a-single-variable-using-histograms" class="nav-link active" data-scroll-target="#understanding-variation-in-a-single-variable-using-histograms"><span class="header-section-number">3.1</span> Understanding variation in a single variable using histograms</a>
  <ul class="collapse">
  <li><a href="#constructing-a-histogram" id="toc-constructing-a-histogram" class="nav-link" data-scroll-target="#constructing-a-histogram"><span class="header-section-number">3.1.1</span> Constructing a Histogram</a></li>
  <li><a href="#the-relative-frequency-scale-absolute-versus-relative-frequency" id="toc-the-relative-frequency-scale-absolute-versus-relative-frequency" class="nav-link" data-scroll-target="#the-relative-frequency-scale-absolute-versus-relative-frequency"><span class="header-section-number">3.1.2</span> The relative frequency scale: Absolute versus relative frequency</a></li>
  <li><a href="#exercises-now-you-try" id="toc-exercises-now-you-try" class="nav-link" data-scroll-target="#exercises-now-you-try"><span class="header-section-number">3.1.3</span> Exercises: Now you try</a></li>
  <li><a href="#best-practices-for-histograms" id="toc-best-practices-for-histograms" class="nav-link" data-scroll-target="#best-practices-for-histograms"><span class="header-section-number">3.1.4</span> Best practices for histograms</a></li>
  </ul></li>
  <li><a href="#sec-moreR" id="toc-sec-moreR" class="nav-link" data-scroll-target="#sec-moreR"><span class="header-section-number">3.2</span> Next steps in R: Reading Data, understanding R objects and selecting and modifying values</a>
  <ul class="collapse">
  <li><a href="#sec-readingdata" id="toc-sec-readingdata" class="nav-link" data-scroll-target="#sec-readingdata"><span class="header-section-number">3.2.1</span> Reading data in R</a></li>
  <li><a href="#sec-robjects" id="toc-sec-robjects" class="nav-link" data-scroll-target="#sec-robjects"><span class="header-section-number">3.2.2</span> R objects</a></li>
  <li><a href="#sec-data_frame" id="toc-sec-data_frame" class="nav-link" data-scroll-target="#sec-data_frame"><span class="header-section-number">3.2.3</span> Data frames and R lists</a></li>
  <li><a href="#data-frames" id="toc-data-frames" class="nav-link" data-scroll-target="#data-frames"><span class="header-section-number">3.2.4</span> Data Frames</a></li>
  <li><a href="#selecting-data-from-r-objects-a-toolbox." id="toc-selecting-data-from-r-objects-a-toolbox." class="nav-link" data-scroll-target="#selecting-data-from-r-objects-a-toolbox."><span class="header-section-number">3.2.5</span> Selecting data from R objects: A toolbox.</a></li>
  <li><a href="#application-reproduce-our-histogram-of-primary-per-capita-energy-consumption-around-the-globe-in-2019-by-a-worked-example." id="toc-application-reproduce-our-histogram-of-primary-per-capita-energy-consumption-around-the-globe-in-2019-by-a-worked-example." class="nav-link" data-scroll-target="#application-reproduce-our-histogram-of-primary-per-capita-energy-consumption-around-the-globe-in-2019-by-a-worked-example."><span class="header-section-number">3.2.6</span> Application: Reproduce our histogram of primary per capita energy consumption around the globe in 2019 by a worked example.</a></li>
  </ul></li>
  <li><a href="#the-average-and-the-standard-deviation" id="toc-the-average-and-the-standard-deviation" class="nav-link" data-scroll-target="#the-average-and-the-standard-deviation"><span class="header-section-number">3.3</span> The average and the standard deviation</a>
  <ul class="collapse">
  <li><a href="#the-average" id="toc-the-average" class="nav-link" data-scroll-target="#the-average"><span class="header-section-number">3.3.1</span> The average</a></li>
  <li><a href="#exercises-for-the-average" id="toc-exercises-for-the-average" class="nav-link" data-scroll-target="#exercises-for-the-average"><span class="header-section-number">3.3.2</span> Exercises for the Average</a></li>
  <li><a href="#the-standard-deviation" id="toc-the-standard-deviation" class="nav-link" data-scroll-target="#the-standard-deviation"><span class="header-section-number">3.3.3</span> The standard deviation</a></li>
  <li><a href="#exercises-for-the-standard-deviation" id="toc-exercises-for-the-standard-deviation" class="nav-link" data-scroll-target="#exercises-for-the-standard-deviation"><span class="header-section-number">3.3.4</span> Exercises for the standard deviation</a></li>
  <li><a href="#computing-the-standard-deviation" id="toc-computing-the-standard-deviation" class="nav-link" data-scroll-target="#computing-the-standard-deviation"><span class="header-section-number">3.3.5</span> Computing the standard deviation</a></li>
  <li><a href="#interquartile-range-and-the-boxplot" id="toc-interquartile-range-and-the-boxplot" class="nav-link" data-scroll-target="#interquartile-range-and-the-boxplot"><span class="header-section-number">3.3.6</span> Interquartile range and the boxplot</a></li>
  </ul></li>
  <li><a href="#describing-differences-between-groups-of-numbers" id="toc-describing-differences-between-groups-of-numbers" class="nav-link" data-scroll-target="#describing-differences-between-groups-of-numbers"><span class="header-section-number">3.4</span> Describing differences between groups of numbers</a></li>
  <li><a href="#describing-relationships-between-data" id="toc-describing-relationships-between-data" class="nav-link" data-scroll-target="#describing-relationships-between-data"><span class="header-section-number">3.5</span> Describing Relationships between data</a></li>
  <li><a href="#describing-trends" id="toc-describing-trends" class="nav-link" data-scroll-target="#describing-trends"><span class="header-section-number">3.6</span> Describing Trends</a></li>
  <li><a href="#summary" id="toc-summary" class="nav-link" data-scroll-target="#summary"><span class="header-section-number">3.7</span> Summary</a></li>
  <li><a href="#computer-exercises" id="toc-computer-exercises" class="nav-link" data-scroll-target="#computer-exercises"><span class="header-section-number">3.8</span> Computer exercises</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Summarizing and communicating lots of data</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p>When we analyze data, we usually have to look at lots of them. An example might be income data gained from household surveys. Such a survey will contain a huge number of data points, in the order of magnitude of thousands or even ten thousands of data, depending on the size of the population on which the survey is taken. These data need to be summarized, to understand their main characteristics.</p>
<p>In this unit you will learn the most important tools for summarizing and communicating lots of data. You are going to learn the principles how data summaries are constructed, what are the properties of these summaries and what needs to be carefully considered.</p>
<p>When we need to deal with really large data sets, and most modern data sets are too large to be handled manually, we will need the computer. We already did some first steps in R. In this unit we will build on these first steps but enlarge them in a way that will enable you to deal and manipulate large datasets on the computer.</p>
<section id="understanding-variation-in-a-single-variable-using-histograms" class="level2 page-columns page-full" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="understanding-variation-in-a-single-variable-using-histograms"><span class="header-section-number">3.1</span> Understanding variation in a single variable using histograms</h2>
<section id="constructing-a-histogram" class="level3 page-columns page-full" data-number="3.1.1">
<h3 data-number="3.1.1" class="anchored" data-anchor-id="constructing-a-histogram"><span class="header-section-number">3.1.1</span> Constructing a Histogram</h3>
<p>To summarize data, statisticians often use a graph which is called a <strong>histogram</strong>. In this section we will discuss all you have to know about histograms and how to use them. Let us start by an example, where we have about 100 data points, which is a lot but not that large that we can not handle them by hand.</p>
<p>The data we want to look at come from measurements of the annual flow of the river Nile at Aswan in Egypt from 1871 to 1970. The units of these measurement in which the annual flow is recorded are 100 millions of cubic meters, i.e.&nbsp;<span class="math inline">\(10^8 m^3\)</span>.</p>
<div class="page-columns page-full"><p>This is one of the data sets that is bundled with the R distribution and is available to all users of R. They are stored in an R object called <code>Nile</code>.<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a></p><div class="no-row-height column-margin column-container"><li id="fn1"><p><sup>1</sup>&nbsp;When you type <code>data()</code> at the R console, you get a list of all datasets that are available with the current distribution of R.</p></li></div></div>
<p>This is how the data look like, when we print them to the R console using the R command <code>print()</code>. The R function <code>options()</code> with the argument <code>width</code>just controls how the numbers are printed. Here I made sure that they will fit in the width of the page.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">width =</span> <span class="dv">70</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(Nile)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Time Series:
Start = 1871 
End = 1970 
Frequency = 1 
  [1] 1120 1160  963 1210 1160 1160  813 1230 1370 1140  995  935 1110
 [14]  994 1020  960 1180  799  958 1140 1100 1210 1150 1250 1260 1220
 [27] 1030 1100  774  840  874  694  940  833  701  916  692 1020 1050
 [40]  969  831  726  456  824  702 1120 1100  832  764  821  768  845
 [53]  864  862  698  845  744  796 1040  759  781  865  845  944  984
 [66]  897  822 1010  771  676  649  846  812  742  801 1040  860  874
 [79]  848  890  744  749  838 1050  918  986  797  923  975  815 1020
 [92]  906  901 1170  912  746  919  718  714  740</code></pre>
</div>
</div>
<div class="page-columns page-full"><p>We start the construction of a histogram by choosing for the horizontal axes ranges of numerical values - in our case of the river flow data - which are called <em>bins</em> or <em>classes</em>. There is no fixed rule as to how to choose the size of these ranges. These ranges should neither be too fine, nor too coarse. While there are lists of mechanical rules, which you can for example find on Wikipedia<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a>, it is usually best to use your domain knowledge and some experimentation to find out the bin size that works best for your data.</p><div class="no-row-height column-margin column-container"><li id="fn2"><p><sup>2</sup>&nbsp;See https://en.wikipedia.org/wiki/Histogram#Number_of_bins_and_width</p></li></div></div>
<div class="page-columns page-full"><p>For this example, assume we had chosen a bin size of 100<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a>. When you study the list, you will find that the lowest value is at 456 while the highest value is at 1370. This is already quite tedious to find out by eyeballing the numbers with the small number of values we have chosen for this example. It is impossible to do for really large data sets.</p><div class="no-row-height column-margin column-container"><li id="fn3"><p><sup>3</sup>&nbsp;Note that this will mean <span class="math inline">\(100\times 10^8 m^3\)</span> per year.</p></li></div></div>
<p>Now lets make a distribution table like this:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">Flow-bin</th>
<th style="text-align: right;">Frequency</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">400 - 500</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">500 - 600</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">600 - 700</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="even">
<td style="text-align: right;">700 - 800</td>
<td style="text-align: right;">20</td>
</tr>
<tr class="odd">
<td style="text-align: right;">800 - 900</td>
<td style="text-align: right;">25</td>
</tr>
<tr class="even">
<td style="text-align: right;">900 - 1000</td>
<td style="text-align: right;">19</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1000 - 1100</td>
<td style="text-align: right;">12</td>
</tr>
<tr class="even">
<td style="text-align: right;">1100 - 1200</td>
<td style="text-align: right;">11</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1200 - 1300</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="even">
<td style="text-align: right;">1300 - 1400</td>
<td style="text-align: right;">1</td>
</tr>
</tbody>
</table>
<p>In the column Flow-bin we have recorded the bins in steps of 100 and in the right column, Frequency, we have recorded the count of values that are in this bin.</p>
<p>When we make such a tabulation we have to agree on an endpoint convention. This is important, since when a flow value would for instance be measured as exactly 500, in which bin should it be counted: 400-500 or 500-600? You, the constructor of the histogram, has to take this decision. Let us agree on the convention that when a value falls exactly at the endpoint of the bin, we put it in the next bin. In practice you will usually do a histogram by computer. The code of the computer program has to specify an endpoint convention, so the computer knows what to do when a value coincides with an endpoint.</p>
<p>On the Frequency axes you put the frequency scale: Counts of values. Then for each bin, you plot a bar, which has the width of the bin and the height of the frequency.</p>
<p>Do this for all the bins you have tabulated and you are ready.</p>
<p>The histogram provides a certain aggregation of the data because it sorts the 100 data points into 10 bins, in our example. While loosing some local information on individual data points the global information conveyed by the summary gives us a pretty good idea of the overall pattern of variation on the Nile river flow data.</p>
<p>We can see, for instance, that the most frequent flow is between 800 and 900 and that the variation is fairly symmetric around this bin. In the extremes this most frequent value can half or almost double, so there is quite some spread in the data.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="pictures/nile_hist.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Constructing the river flow histogram</figcaption>
</figure>
</div>
<p>If we had just plotted all individual data points, we also got a picture, though you probably agree that it is not particularly useful.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">as.numeric</span>(Nile), <span class="at">xlab =</span> <span class="st">"Observation"</span>, <span class="at">ylab =</span> <span class="st">"Annual Flow"</span>, <span class="at">pch =</span> <span class="dv">16</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="summarizing_and_communicating_lots_of_data_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Histograms are such a common tool in statistics to explore the variation in one variable and the shape, how it is roughly distributed that every statistical software has functions to produce histograms. In R, the language we use in this course, there is also such a function. The function name is called <code>hist()</code> and it takes the data as an argument. This is the second graphic function of R you encounter in this course after we played with the <code>barplot()</code>function in the last lecture.</p>
<p>To produce a histogram from the river flow data, we type at the console</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(Nile)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="summarizing_and_communicating_lots_of_data_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Now you try
</div>
</div>
<div class="callout-body-container callout-body">
<p>Let us check your understanding of histograms by a little quiz now. The histogram below shows the distribution of the final score in a certain class.</p>
<ol type="a">
<li>Which block represents the people who scored between 60 and 80?</li>
<li>Ten percent scored between 20 and 40 about what percentage scored between 40 and 60?</li>
<li>About what percentage scored over 60?</li>
</ol>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="pictures/final_score.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Final Score</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="the-relative-frequency-scale-absolute-versus-relative-frequency" class="level3 page-columns page-full" data-number="3.1.2">
<h3 data-number="3.1.2" class="anchored" data-anchor-id="the-relative-frequency-scale-absolute-versus-relative-frequency"><span class="header-section-number">3.1.2</span> The relative frequency scale: Absolute versus relative frequency</h3>
<p>Sometimes it might be useful, to choose a different scale for the y axes of your histogram. Instead of absolute frequencies (or counts) it might be useful to show relative frequencies, the proportion of occurrences in each bin. The type of scale you choose will depend on what kind of comparisons you want to emphasize about your data.</p>
<div class="page-columns page-full"><p>Let us look at this issue by an example. The numbers we want to look at report primary energy consumption per capita in kwh per person per year for different countries around the world.<a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a> The energy numbers refer to primary energy – the energy input before the transformation to forms of energy for end-use (such as electricity or petrol for transport).</p><div class="no-row-height column-margin column-container"><li id="fn4"><p><sup>4</sup>&nbsp;A kilowatt-hour, known as Kwh is a way to measure how much energy is used. A kilowatt-hour is the amount of energy used if a 100 watt appliance is kept running for an hour. For instance, if you turned on a 100 watt bulb for one hour you are using a kilowatt-hour of energy. What’s the difference between kilowatt vs.&nbsp;kilowatt-hour? A kilowatt is 1,000 watts, which is a measure of power. A kilowatt-hour is a measure of the amount of energy a certain machine needs to run for one hour. So, if you have a 1,000 watt drill, it takes 1,000 watts (or one kW) to make it work. If you run that drill for one hour, you’ll have used up one kilowatt of energy for that hour, or one kWh. Obviously, every appliance will use a different amount of power. Here are some of the usages for some items in a home: 50″ LED Television: around 0.016 kWh per hour, electric water heater: 380-500 kWh per month</p></li></div></div>
<p>Let us look at the year 2019.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(JWL)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">with</span>(energy_consumption_per_capita, energy_consumption_per_capita[Year <span class="sc">==</span> <span class="dv">2019</span>, ])</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>hist_info <span class="ot">&lt;-</span> <span class="fu">hist</span>(dat<span class="sc">$</span>Cons, <span class="at">plot =</span> <span class="cn">FALSE</span>)         <span class="co"># Store output of hist function</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>hist_info<span class="sc">$</span>counts <span class="ot">&lt;-</span> hist_info<span class="sc">$</span>counts <span class="sc">/</span>    <span class="co"># Compute relative frequency values</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sum</span>(hist_info<span class="sc">$</span>counts) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(hist_info, <span class="at">freq =</span> <span class="cn">TRUE</span>, <span class="at">xlab =</span> <span class="st">"Primary energy consumption in kilowatt-hours per person per year."</span>, <span class="at">ylab =</span> <span class="st">"Percent"</span>, <span class="at">main =</span> <span class="st">"Primary energy Consuption per Capita 2019"</span>)              <span class="co"># Plot histogram with percentages</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="summarizing_and_communicating_lots_of_data_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>In this histogram you see the distribution of per capita primary energy consumption for the year 2019 for countries around the globe. But now the y axes shows relative frequencies instead of counts.</p>
<p>For example, you see from the graph that roughly 55 % of countries have a primary energy consumption smaller that 20.000 kilowatt hours per person in this year. The next larger bucket contains already roughly half or 24 %. The biggest buckets are then a very small fraction of countries in the world. This means that there is a relatively small share of countries, around 20 %, which have a large primary energy consumption per capita. One says in the language of statistics that the distribution of per capita primary energy consumption is skewed. When you have a histogram with a relative frequency scale the lengths of the bars must sum to 1 (or to 100 depending whether the relative frequency is expressed in decimal fractions or in percentages).</p>
</section>
<section id="exercises-now-you-try" class="level3" data-number="3.1.3">
<h3 data-number="3.1.3" class="anchored" data-anchor-id="exercises-now-you-try"><span class="header-section-number">3.1.3</span> Exercises: Now you try</h3>
<ol type="1">
<li>A histogram of monthly wages for part-time employees is shown below (relative frequencies are marked in parenthesis). Nobody earned more than $1000 a month. The block over the class interval from 200 to 300 is missing. How tall must it be?</li>
</ol>
<p><img src="pictures/wages.png" class="img-fluid" alt="Wages"> 2. Three people plot histograms for the weights of subjects in a study, using the relative frequency scale. Only one is right. Which one and why?</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo = false</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(JWL)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> height_weight</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> dat[dat<span class="sc">$</span>state <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> dat<span class="sc">$</span>sex <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> dat<span class="sc">$</span>age <span class="sc">&gt;</span> <span class="dv">18</span>, ]</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>hist_inf <span class="ot">&lt;-</span> <span class="fu">hist</span>(data<span class="sc">$</span>height, <span class="at">plot =</span> <span class="cn">FALSE</span>)         <span class="co"># Store output of hist function</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>hist_inf<span class="sc">$</span>density <span class="ot">&lt;-</span> hist_inf<span class="sc">$</span>counts <span class="sc">/</span>    <span class="co"># Compute density values</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sum</span>(hist_inf<span class="sc">$</span>counts) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a><span class="fu">png</span>(<span class="at">file=</span><span class="st">"pictures/hight_version1.png"</span>)</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(hist_inf, <span class="at">freq =</span> <span class="cn">FALSE</span>, <span class="at">xlab =</span> <span class="st">" "</span>, <span class="at">ylab =</span> <span class="st">" "</span>, <span class="at">main =</span> <span class="st">" "</span>)</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a><span class="fu">png</span>(<span class="at">file=</span><span class="st">"pictures/hight_version2.png"</span>)</span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(hist_inf, <span class="at">freq =</span> <span class="cn">FALSE</span>, <span class="at">xlab =</span> <span class="st">"hight (cm) "</span>, <span class="at">ylab =</span> <span class="st">"Percent per 5 cm "</span>, <span class="at">main =</span> <span class="st">" "</span>)</span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a><span class="fu">png</span>(<span class="at">file=</span><span class="st">"pictures/hight_version3.png"</span>)</span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(hist_inf, <span class="at">freq =</span> <span class="cn">FALSE</span>, <span class="at">xlab =</span> <span class="st">"hight (cm) "</span>, <span class="at">ylab =</span> <span class="st">"5 cm per percent"</span>, <span class="at">main =</span> <span class="st">" "</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="fig-height_hist" class="quarto-layout-panel">
<figure class="figure">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 33.3%;justify-content: center;">
<div id="fig-hight-hist-version1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="pictures/hight_version1.png" class="img-fluid figure-img" data-ref-parent="fig-height_hist"></p>
<figcaption class="figure-caption">(a) Version 1</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 33.3%;justify-content: center;">
<div id="fig-hight-hist-version2" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="pictures/hight_version2.png" class="img-fluid figure-img" data-ref-parent="fig-height_hist"></p>
<figcaption class="figure-caption">(b) Version 2</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 33.3%;justify-content: center;">
<div id="fig-hight-hist-version3" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="pictures/hight_version3.png" class="img-fluid figure-img" data-ref-parent="fig-height_hist"></p>
<figcaption class="figure-caption">(c) Version 3</figcaption>
</figure>
</div>
</div>
</div>
<p></p><figcaption class="figure-caption">Figure&nbsp;3.1: Three versions of a hight histogram of males over age 18</figcaption><p></p>
</figure>
</div>
<ol start="3" type="1">
<li><p>An investigator draws a histogram for some height data, using the metric system. She is working in centimeters (cm). She wants to draw the histogram in a so called density scale, i.e.&nbsp;in a scale that the area of all the bars sum to 1. The vertical axes shows relative frequency and the top of the vertical axes is 10 percent per cm. Now she wants to convert to millimeter (mm). There are 10 millimeter to the centimeter. On the horizontal axis, she has to change 175 cm to ? mm, 200 cam to ? mm. On the vertical axis she has to change 10 percent per cm to ? percent per mm, and 5 percent per cm to ? percent per mm.</p></li>
<li><p>In a Public Health Service study, a histogram was plotted showing the number of cigarettes per day smoked by each subject (male current smokers), as shown in the histogram below. The density is marked in parentheses. The class interval include the right endpoint, not the left.</p>
<ol type="a">
<li><p>The percentage who smoked 10 cigarettes or less per day is around:</p>
<p>1.5% 15% 30% 50%</p></li>
<li><p>The percentage who smoked more than a pack a day, but not more than 2 packs, is around</p>
<p>1.5% 15 % 30% 50% (There are 20 cigarettes in a pack)</p></li>
<li><p>The percentage who smoked more than a pack a day is around</p>
<p>1.5%, 15%, 30%, 50%</p></li>
<li><p>The percent who smoked more than 3 packs a day is around</p>
<p>0.25 of 1%, 0.5 of 1%, 10 %</p></li>
<li><p>The percent who smoked 15 cigarettes per day is around</p>
<p>0.35 of 1%, 0.5 of 1%, 1.5%, 3.5%, 10%</p></li>
</ol></li>
</ol>
<div id="fig-hight-cigarettes" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="pictures/cigarettes.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Figure&nbsp;3.2: Number of cigarettes</figcaption>
</figure>
</div>
</section>
<section id="best-practices-for-histograms" class="level3" data-number="3.1.4">
<h3 data-number="3.1.4" class="anchored" data-anchor-id="best-practices-for-histograms"><span class="header-section-number">3.1.4</span> Best practices for histograms</h3>
<p>When you summarize lots of data by a histogram there are some things you should consider carefully. Let us go through the most important best practice principles for histograms.</p>
<section id="bin-size" class="level4" data-number="3.1.4.1">
<h4 data-number="3.1.4.1" class="anchored" data-anchor-id="bin-size"><span class="header-section-number">3.1.4.1</span> Bin size</h4>
<p>When doing exploratory data work it is usually a good idea not to look at a single histogram but at several histograms of the same data by changing the bin size. There is no clear rule about the optimal bin size. It often depends on context and field knowledge.</p>
<p>If the bins are to fine, then the data will be be very noisy and give no overview because they show too many individual points. On the other hand if the bins are too wide, they will not show you the overall variability in the data very well and you fail to get a good idea about the distribution.</p>
<p>Let us illustrate this point using the river flow data of the Nile.</p>
<p>In the first case we have chosen 100 bins, which is too fine. There is almost one bar for every single data point. In this way we have a lot of spurious peaks and throughs and can not see the variation pattern in the data very clearly</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(Nile, <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="fu">min</span>(Nile), <span class="fu">max</span>(Nile), <span class="at">length.out =</span> <span class="dv">100</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="summarizing_and_communicating_lots_of_data_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Now here we have the other extreme, lets assume we have only 3 bins. This would give us a pattern like this.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(Nile, <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="fu">min</span>(Nile), <span class="fu">max</span>(Nile), <span class="at">length.out =</span> <span class="dv">3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="summarizing_and_communicating_lots_of_data_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Here the histogram is too coarse and we do not see the variation pattern either.</p>
<p>The computer usually has a built in rule of thumb for the histogram which will work well in most of the cases. Still for individual datasets it is sometimes better to choose a different bin size that more adequately mirrors the variation in the data.</p>
</section>
<section id="choose-boundaries-that-can-be-clearly-interpreted" class="level4" data-number="3.1.4.2">
<h4 data-number="3.1.4.2" class="anchored" data-anchor-id="choose-boundaries-that-can-be-clearly-interpreted"><span class="header-section-number">3.1.4.2</span> Choose boundaries that can be clearly interpreted</h4>
<p>Tick marks and labels should fall on the bin boundaries. As in the examples discussed so far, they need not be there for every tick but it is enough if they are there between every few bars. Bin labels should also have not many significant digits, so they are easy to read. So bin sized which divide 10 and 20 evenly are easier to read than bin sizes that do not. So always take caution not to arbitrarily split bin sizes. Otherwise you can end up with off bin boundaries.</p>
<p>For example, if we just took the maximum and the minimum of the Nile river flow data and arbitrarily divided them into 7 bins, we would get the difficult to read bin boundaries</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">seq</span>(<span class="fu">min</span>(Nile), <span class="fu">max</span>(Nile), <span class="at">length.out =</span> <span class="dv">7</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  456.0000  608.3333  760.6667  913.0000 1065.3333 1217.6667
[7] 1370.0000</code></pre>
</div>
</div>
<p>instead of the more easily readable boundaries</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">seq</span>(<span class="dv">400</span>,<span class="dv">1200</span>,<span class="dv">100</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  400  500  600  700  800  900 1000 1100 1200</code></pre>
</div>
</div>
</section>
<section id="whats-the-difference-between-a-histogram-and-a-bar-chart" class="level4" data-number="3.1.4.3">
<h4 data-number="3.1.4.3" class="anchored" data-anchor-id="whats-the-difference-between-a-histogram-and-a-bar-chart"><span class="header-section-number">3.1.4.3</span> What’s the difference between a histogram and a bar chart?</h4>
<p>A histogram depicts the frequency distribution of a continuous, quantitative variable, such as height, weight, time, energy consumption etc. These are variables that can take on any value and these values can be ordered from smallest to highest.</p>
<p>When we have a categorical variable, like we encountered them in section 2, we need to use a bar chart. The bars of the bar chart typically will have a small gap between the bars, emphasizing the discrete nature of the variable. The categories in a bar chart usually have no natural ordering. As we discussed in section 2, we have even to be conscious how we display the categories to avoid suggesting an order that is in fact not there in the data.</p>
</section>
</section>
</section>
<section id="sec-moreR" class="level2 page-columns page-full" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="sec-moreR"><span class="header-section-number">3.2</span> Next steps in R: Reading Data, understanding R objects and selecting and modifying values</h2>
<p>Before we go on with learning the tools to summarize and communicate lots of data let us gain more skills for handling the tool that will actually enable you to handle large data sets yourself by making use of R. Building on what we learned in the last unit, lets now push your knowledge of R bit further.</p>
<section id="sec-readingdata" class="level3 page-columns page-full" data-number="3.2.1">
<h3 data-number="3.2.1" class="anchored" data-anchor-id="sec-readingdata"><span class="header-section-number">3.2.1</span> Reading data in R</h3>
<p>Before we can do anything with data, we need first to learn how to load data into R and how to save them. We will discuss now how to do this for the case of <em>comma separated text files</em> or so called <em>csv</em> files. R provides functions for reading and writing from almost any other format, like data stored in Excel files and many more data formats that are used today. Since in all those different formats are read by R following the same principles as in the csv case, it is sufficient if we discuss here the the case of csv files only.</p>
<p>We have discussed a data set of per capita primary energy use in countries around the globe to produce a histogram of these data for the year 2019. How did I get these data into R?</p>
<p>First of all I could access these data because helpful people at Oxford University in the UK who maintain and run the website “Our world in data”, which we have encountered before, store these data on their website. In the concrete case of the energy data, they can currently be found at https://ourworldindata.org/grapher/per-capita-energy-use where you can download the datafile from the webpage and save it locally somewhere on your computer.</p>
<p>I have taken a screenshot here</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="pictures/our_world_in_data_energy.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Our World in Data website energy</figcaption>
</figure>
</div>
<div class="page-columns page-full"><p>In the lower right corner you see a box called Data and a download button. This button allows you to download the dataset to your machine. The file is called <code>per-capita-energy-use.csv</code>. From the extension of the file <code>csv</code>, you can see that it is a comma separated text file. This is a plain text file following certain formatting rules. In particular individual data points are separated by a comma<a href="#fn5" class="footnote-ref" id="fnref5" role="doc-noteref"><sup>5</sup></a></p><div class="no-row-height column-margin column-container"><li id="fn5"><p><sup>5</sup>&nbsp;The standard format for csv can be looked up here https://www.ietf.org/rfc/rfc4180.txt. Despite this standardization it can occur that different files use different conventions for the notation of the decimal comma sign. In the most common specification this symbols is a dot (.) and in others it is a comma (,). For such speical cases R provides special functions, which we will explain in the text.</p></li></div></div>
<p>I have stored the file in a sub-folder to the directory in which I am writing these lecture notes. If you decide to download this file, you will save it somewhere on your machine where you find it appropriate. Perhaps you have a folder for this course and in this folder you have a sub-folder where you store all the data sets we are using in the course.</p>
<p>To read a csv file, R provides the function <code>read.csv()</code>. If the csv file comes with a European instead of an US decimal format (<code>,</code> instead of <code>.</code> for the decimal sign.) you need to use the function <code>read.csv2()</code>. Please check out the documentation of these functions by typing <code>?read.csv</code> at the R prompt.</p>
<p>In the simplest form you read the data and store them in an object you can work with in R. How to store data in an R object, we have already learned in the previous lecture. You invent a name and assign the values to this name using the assignment operator <code>&lt;-</code>.</p>
<p>Let’s call the object in which we save our data <code>energy_consumption</code>, then by calling the function <code>read.csv()</code> with the path to your file as an argument will read the data from your local folder and store them in the object we have created. This allows us to refer to the data for doing further computations.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>energy_consumption <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"data/energy_use_per_capita/per-capita-energy-use.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The function needs as an argument the file name. If the file is in a sub-folder of the current directory you need to also specify the path. To specify the correct path to the file you need to know in which part of your directory tree you are currently working.</p>
<p>In my case I am working in the project folder for my lecture notes, which has a sub-folder called <code>data</code>. The data sub-folder has a further sub-folder called <code>energy_use_per_capita</code> in my case and thus I specify the path relative to this location.</p>
<p>To find out what is your current R working directory, R provides the function <code>getwd()</code>. If I type this in my case, I will get</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">getwd</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "/home/martinsummer/R/Statistics_JWL"</code></pre>
</div>
</div>
<p>the path of my project folder for this lecture notes. So if I type the string <code>"data/energy_use_per_capita/per-capita-energy-use.csv"</code> this specifies the path relative to my working directory.</p>
<p>If you read the file on your computer, you need to specify the path appropriately from where you are working in R at the moment to where you have stored the csv file.</p>
<p>Now <code>read.csv()</code> has many additional arguments, which provide you with lots of flexibility. I encourage you to check it out and play with it using the help function and the examples given therein by typing <code>?read.csv</code> at the prompt.</p>
<p>We have now read the primary energy consumption data and written it to the R-object <code>energy_consumption</code>. Lets inspect the object a bit to see what we’ve got.</p>
<p>I use the function <code>head()</code> with the parameter value <code>n = 10</code>. This will show me the first 10 rows of the data-file. So the value I give to the argument <code>n</code> contros how many rows will be displayed.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">width =</span> <span class="dv">120</span>)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(energy_consumption, <span class="at">n =</span> <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        Entity Code Year Primary.energy.consumption.per.capita..kWh.person.
1  Afghanistan  AFG 1980                                           583.2944
2  Afghanistan  AFG 1981                                           666.3782
3  Afghanistan  AFG 1982                                           725.6599
4  Afghanistan  AFG 1983                                           912.1396
5  Afghanistan  AFG 1984                                           941.3926
6  Afghanistan  AFG 1985                                           939.6124
7  Afghanistan  AFG 1986                                           976.6691
8  Afghanistan  AFG 1987                                          1592.7023
9  Afghanistan  AFG 1988                                          2805.6096
10 Afghanistan  AFG 1989                                          2700.4739</code></pre>
</div>
</div>
<p>This gives you an idea what the data look like. There are four variables, called <code>Entity</code>, <code>Code</code>, <code>Year</code> and <code>Primary.energy.consumption.per.capita..kWh.person.</code> The last variable name is very informative but also very long and unpractical. We will learn how to change variable names soon. Because of the long name, I had to use the function <code>options()</code> before <code>heads()</code> to tell R to use a sufficiently wide display. Don’t worry for this detail at the moment.</p>
</section>
<section id="sec-robjects" class="level3 page-columns page-full" data-number="3.2.2">
<h3 data-number="3.2.2" class="anchored" data-anchor-id="sec-robjects"><span class="header-section-number">3.2.2</span> R objects</h3>
<p>The most basic type of R objects are <strong>atomic vectors</strong>. Objects in R are built from atomic vectors.</p>
<p>The energy consumption data-file we have just loaded is an example of such a more complex structure built from atomic vectors. We have already encountered a few of those in our previous lecture.</p>
<section id="sec-atomic" class="level4" data-number="3.2.2.1">
<h4 data-number="3.2.2.1" class="anchored" data-anchor-id="sec-atomic"><span class="header-section-number">3.2.2.1</span> Atomic vectors</h4>
<p>An atomic vector is just a simple vector of data. For example remember when we typed the infant mortality data for eight European countries for 1860 we typed</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>mr_1860 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.237</span>, <span class="fl">0.139</span>, <span class="fl">0.136</span>, <span class="fl">0.150</span>, <span class="fl">0.260</span>, <span class="fl">0.102</span>, <span class="fl">0.174</span>, <span class="fl">0.124</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In this case <code>mr_1860</code> is an atomic vector.</p>
<p>R has a function, which allows you to check whether an object is an atomic vector or not. This function is called <code>is.vector()</code>. It takes the object name as an argument and returns <code>TRUE</code> if the object is an atomic vector and <code>FALSE</code> if it is not.</p>
<p>For example:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">is.vector</span>(mr_1860)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
</div>
<p>does indeed return <code>TRUE</code>.</p>
<p>Each atomic vector stores values in a one-dimensional vector, and each atomic vector can only store one type of data. The length of the atomic vector can be determined by the function <code>length()</code> This function takes an R object, which is an atomic vector, as an argument and returns the number of elements in this vector. Here is the example of the die</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(mr_1860)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 8</code></pre>
</div>
</div>
<p>which is 8 as it should be. An atomic vector could also have only one element, in which case <code>lenght()</code>would return 1.</p>
</section>
<section id="sec-datatypes" class="level4 page-columns page-full" data-number="3.2.2.2">
<h4 data-number="3.2.2.2" class="anchored" data-anchor-id="sec-datatypes"><span class="header-section-number">3.2.2.2</span> Data types</h4>
<p>Now altogether R has implemented <em>six basic types of atomic vectors</em>:</p>
<ol type="1">
<li><p>double</p></li>
<li><p>integers</p></li>
<li><p>characters</p></li>
<li><p>logical</p></li>
<li><p>complex</p></li>
<li><p>raw</p></li>
</ol>
<p>We will not encounter complex and raw data-types in this course, so let us skip those and discuss only the first 4 types, double, integer, character and logical.</p>
<p>If yo u go back to our energy consumption data and look at the first three lines</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">width =</span> <span class="dv">120</span>)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(energy_consumption, <span class="at">n=</span><span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>       Entity Code Year Primary.energy.consumption.per.capita..kWh.person.
1 Afghanistan  AFG 1980                                           583.2944
2 Afghanistan  AFG 1981                                           666.3782
3 Afghanistan  AFG 1982                                           725.6599</code></pre>
</div>
</div>
<p>you will see the different variables in the object <code>energy_consumption</code>. Note that I had to fudge a bit with the display because of the unwieldy and long name of the last variable. We are soon going to fix this.</p>
<p>The variables <code>Entity</code> and <code>Code</code> are both of type <em>character</em>. A character vector stores strings of text, which have to be put between quotation marks <code>""</code>. Strings are the individual elements of a character vector.</p>
<p>Note that a string can be more than just letters. If you type, for instance the number <code>1</code> with quotation marks, like <code>"1"</code> R would interpret the value as a string not as a number. Sometimes one can get confused in R because both objects and characters appear as text in R code. Object names are without quotation marks strings always are between quotation marks.</p>
<div class="page-columns page-full"><p>Character is the natural data type for country names - here “Afghanistan” and the international abbreviation “AFG” also called an ISO-country code<a href="#fn6" class="footnote-ref" id="fnref6" role="doc-noteref"><sup>6</sup></a></p><div class="no-row-height column-margin column-container"><li id="fn6"><p><sup>6</sup>&nbsp;ISO is the short name for International Organization for Standardization. International Organization for Standardization came into existence in the year 1946 in London. This organization was formed after a delegation of 65 members from 25 countries, met to discuss the future of International Standardization. In 1947, ISO was officially formed with 67 technical committees consisting of a group of experts focusing on a specific subject. ISO founders decided to give it an acronym ISO, which was based on the Greek word ‘isos’, which means ‘equal’.</p></li></div></div>
<p>The variable <code>Year</code> encodes the year of a particular record or observation. Its type is <code>integer</code>, since years are integer values like 1980 or 2022. If yo want to specify a number explicitly as integer in R you have to type it as, say, <code>1980L</code>, the number followed without space by a big <code>L</code>.</p>
<p>The variable with the very long name <code>Primary.energy.consumption.per.capita..kWh.person.</code> is of type double. This is the data type in R for encoding numbers that are decimal fractions, like <code>12.451</code></p>
<p>Now why should we care for distinguishing integers from doubles? This has to do with the way a computer does computations. Sometimes a difference in precision can have surprising effects.</p>
<div class="page-columns page-full"><p>In your computer 64bits of memory<a href="#fn7" class="footnote-ref" id="fnref7" role="doc-noteref"><sup>7</sup></a> are allocated for each double in an R program. While this allows for a very precise representation of numbers not all numbers can be exactly represented with 64-bits. The famous candidates are <span class="math inline">\(\pi\)</span>, which has an infinite sequence of digits and must therefore be rounded by the computer. Usually the rounding error introduced into your computations will go unnoticed but sometimes surprises can occur.</p><div class="no-row-height column-margin column-container"><li id="fn7"><p><sup>7</sup>&nbsp;A bit is a binary digit, the smallest increment of data on a computer. A bit can hold only one of two values: 0 or 1, corresponding to the electrical values of off or on, respectively. So 64 bits are sequences of 0 or 1 with a length of 64</p></li></div></div>
<p>Take for instance:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sqrt</span>(<span class="dv">2</span>)<span class="sc">^</span><span class="dv">2</span> <span class="sc">-</span> <span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4.440892e-16</code></pre>
</div>
</div>
<div class="page-columns page-full"><p>Why is that? The square root of 2 can not be expresses precisely because, as already the old Greeks knew, it is not a rational number.<a href="#fn8" class="footnote-ref" id="fnref8" role="doc-noteref"><sup>8</sup></a></p><div class="no-row-height column-margin column-container"><li id="fn8"><p><sup>8</sup>&nbsp;Let me invite you to a short digression into the history of science and the history of ideas. The discovery that <span class="math inline">\(\sqrt{2}\)</span> can not be rational was a shock discovery to the ancient Greeks. The Greek mathematician Pythagoras and his followers were fascinated by and devoted to whole numbers. They detected the fundamental role played by ratios of whole numbers for musical harmony. For example dividing a vibrating string in two half raises the pitch by an octave, dividing the string in three raises the pitch by one fifths and so on. This discovery gave them the clue that the physical world as a whole might have an underlying mathematical structure governed by whole-number patterns. It was thus quite a shock when they found out that one of their foundational discoveries the Pythagorean theorem logically implied that there were ratios of lengths that were incommensurable, that is, not measurable as integer multiples of the same unit. The ratio between such lengths is therefore not a ratio of whole numbers. This is why the Greeks called these numbers irrational. Some of you will remember from school that the Pythagorean theorem says that in a right angled triangle with lengths <span class="math inline">\(a\)</span>, <span class="math inline">\(b\)</span> and <span class="math inline">\(c\)</span>, where the sides with length <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span> from a right angle must fulfill the equation <span class="math inline">\(a^2 + b^2 = c^2\)</span> or expressed in a picture <img src="pictures/pythagoras.png" id="fig-pyth" class="img-fluid" alt="The Pythagorean theorem"> The incommensurable lengths disovered by one member of the pythagorean school was the side and the diagonal of the unit square. By the Pythagorean theorem in a square with side length of 1 it must be the case that <span class="math inline">\(\text{(lenght of diagonal)}^2 = 1 + 1 = 2\)</span>. Thus the length of the diagonal must be <span class="math inline">\(\sqrt{2}\)</span>. <img src="pictures/unit_square.png" id="fig-usq" class="img-fluid" alt="Length of diagonal in a unit square"> Hence if the diagonal and side are in the ratio <span class="math inline">\(m/n\)</span> (where <span class="math inline">\(m\)</span> and <span class="math inline">\(n\)</span> can be assumed to have no common divisor), we have <span class="math display">\[\begin{equation}
m^2/n^2 = 2
\end{equation}\]</span> thus <span class="math display">\[\begin{equation}
m^2 = 2 n^2
\end{equation}\]</span> This equation implies that <span class="math inline">\(m^2\)</span> must be an even number. So <span class="math inline">\(m\)</span> must be even too, say <span class="math inline">\(m = 2 p\)</span>. But if <span class="math display">\[\begin{equation}
m = 2 p
\end{equation}\]</span> then we have <span class="math display">\[\begin{equation}
2 n^2 = m^2 = 4 p^2
\end{equation}\]</span> hence <span class="math display">\[\begin{equation}
n^2 = 2 p^2
\end{equation}\]</span> which similarly implies that <span class="math inline">\(n\)</span> is even. But we began the chain of deductions by the assumption that <span class="math inline">\(m\)</span> and <span class="math inline">\(n\)</span> have no common divisor. So if both <span class="math inline">\(m\)</span> and <span class="math inline">\(n\)</span> were even they would have a common divisor, namely 2. We have arrived at a contradiction. This means the length of the diagonal of the unit square can not be a rational number. Legend has it that th first Pythagorean to make the result public was drowned at sea. But even if the Pythagoreans could not accept that <span class="math inline">\(\sqrt{2}\)</span> was a number, no one could deny that it was the length of the diagonal of the unit square.</p></li></div></div>
<p>And you have a small rounding error. Let me explain to those of you who are puzzled by the meaning of this output. R displays the result of its computation in scientific notation. <code>4.440892e-16</code> means <span class="math inline">\(4.44089 \times 10^{-16}\)</span>.</p>
<p>For those of you who forgot how exponential notation works, let me remind you that we write <span class="math inline">\(10^{-1}\)</span> for <span class="math inline">\(1/10\)</span> and <span class="math inline">\(10^{-2}\)</span> means <span class="math inline">\(1/10^2\)</span> or <span class="math inline">\(1/100\)</span>. Thus <span class="math inline">\(10^{-16}\)</span> means <span class="math inline">\(1/10.000.000.000.000.000\)</span>, a very small number but still different from 0. This is the error introduced by rounding <span class="math inline">\(\sqrt{2}\)</span>. Such errors are called <em>floating point errors</em> in computer science lingo and computing with such numbers is called <em>floating-point-arithmetic</em>.</p>
<p>With integers floating point errors are avoided, but for many applications this is not an option. Luckily for most cases floating-point arithmetic provides sufficient precision for most of the applications we encounter in practice.</p>
<p>The last data type in the list, we want to discuss here, are: <strong>Logicals</strong>. Logical vectors store <code>TRUE</code> and <code>FALSE</code>; logical values. They are extremely useful for doing comparisons and - as we will see shortly - also for selecting values from a data set.</p>
<p>How logical data types work can best be understood by an example. If you type, for instance:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span> <span class="sc">&gt;</span> <span class="dv">1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] FALSE</code></pre>
</div>
</div>
<p>R tells you that this statement is false, by printing the logical value <code>FALSE</code> as an output.</p>
<p>Whenever you type <code>TRUE</code> of <code>FALSE</code> without quotation marks, R will treat the input as logical data. Note, as an aside, if you typed <code>"TRUE"</code>and <code>"FALSE"</code> in quotation marks, R would treat this input as a string co characters, a different data type. When communicating with a computer, you need to be very precise or the machine will not understand what you want to tell it do.</p>
<p>For instance, the following statement yields:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: false</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>logic <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="cn">TRUE</span>, <span class="cn">FALSE</span>, <span class="cn">TRUE</span>)</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>logic</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  TRUE FALSE  TRUE</code></pre>
</div>
</div>
</section>
<section id="sec-attributes" class="level4" data-number="3.2.2.3">
<h4 data-number="3.2.2.3" class="anchored" data-anchor-id="sec-attributes"><span class="header-section-number">3.2.2.3</span> Attributes</h4>
<p>One important R-fact which you need to know about atomic vectors is that atomic vectors can have <strong>attributes</strong>. Attributes won’t affect the values of an object but can hold and store object metadata.</p>
<p>Normally we do not look at these metadata, but many R functions check for attributes and then do special things with the object depending on these attributes. Attributes can be checked with the function <code>attributes()</code> using an R object as an argument. This will show you all the attributes that are attached to an R object.</p>
<p>The most common attributes for atomic vectors as well as R objects built from atomic vectors are <strong>names</strong>, <strong>dimensions</strong> and <strong>classes</strong>. Each of these attributes has its own helper function that you can use to also assign attributes to the object. For what we need now we discuss <code>names</code> and <code>dimensions</code> and discuss <code>classes</code>, which is a more advanced topic later.</p>
<p>Let us look how this works with the <code>enegrgy_consumption</code>data and check whether they have a names attribute:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(energy_consumption)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Entity"                                             "Code"                                              
[3] "Year"                                               "Primary.energy.consumption.per.capita..kWh.person."</code></pre>
</div>
</div>
<p>We can now see the variable names. We can use the function <code>names()</code>also as a helper function to assign other names to our variables. This is a tool that could help us to get rid of the very long and unwieldy name <code>"Primary.energy.consumption.per.capita..kWh.person."</code>. For example:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(energy_consumption) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Entity"</span>, <span class="st">"Code"</span>, <span class="st">"Year"</span>, <span class="st">"Cons"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>will overwrite the name attribute by this new vector of names. When you now look for the names attribute, you will see</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(energy_consumption)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Entity" "Code"   "Year"   "Cons"  </code></pre>
</div>
</div>
<p>One very important attribute, we will encounter all the time is <strong>dimension</strong>, with the helper function <code>dim()</code>. For example we can look at our data object <code>energy_consumption</code> again to get:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(energy_consumption)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 10215     4</code></pre>
</div>
</div>
<p>which returns two numbers, which mean that the object has 10215 rows and 4 columns.</p>
</section>
<section id="factors" class="level4" data-number="3.2.2.4">
<h4 data-number="3.2.2.4" class="anchored" data-anchor-id="factors"><span class="header-section-number">3.2.2.4</span> Factors</h4>
<p>R stores categorical data, such as nationality, sex etc. by using aspeical data type called <strong>factors</strong>. If you take for instance, sex, it can have only two values - male or female - and these values may have their idiosyncratic order, for example that females go always first.</p>
<p>To make a factor in R you have to pass an atomic vector to the <code>factor()</code> function. This function works by recoding the values in the vector as integers and store the results in an integer vector. R also adds a <code>level</code> attribute which contains the set of labels and their order and a class attribute that says the vector is a factor. Example:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>sex <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="st">"m"</span>, <span class="st">"f"</span>, <span class="st">"f"</span>, <span class="st">"m"</span>))</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="fu">typeof</span>(sex)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "integer"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">attributes</span>(sex)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$levels
[1] "f" "m"

$class
[1] "factor"</code></pre>
</div>
</div>
<p>Factors can be confusing since they look like characters but behave like integers.</p>
<p>Note that R will often try to convert character strings to factors when you load and create data. I recommend that you do not allow R to make factors unless you explicitly ask for it. This can usually be controlled by an argument to whatever the data reader function is. For instance you can give the <code>read.csv()</code> function the argument <code>stringsAsFactors = FALSE</code>.</p>
<p>R has an internal <strong>coercion</strong> behavior for data types, which you should know about if you work with R. With this knowledge you can do many useful things.</p>
<p>If a character string is present in an atomic vector, R will automatically convert every other component in this vector to a character string. If a vector contains only logicals and numbers, R will convert the logicals to numbers. In this case every <code>TRUE</code> becomes a 1 and every <code>FALSE</code> becomes a 0.</p>
<p>R also uses the coercion rules, when we do math with logicals, like for example</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">c</span>(<span class="cn">TRUE</span>, <span class="cn">TRUE</span>, <span class="cn">FALSE</span>, <span class="cn">FALSE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2</code></pre>
</div>
</div>
<p>What happens here is that R coerces the vector <code>c(TRUE, TRUE, FALSE, FALSE)</code> to the vector <code>c(1, 1, 0, 0)</code> and sums the components.</p>
</section>
</section>
<section id="sec-data_frame" class="level3" data-number="3.2.3">
<h3 data-number="3.2.3" class="anchored" data-anchor-id="sec-data_frame"><span class="header-section-number">3.2.3</span> Data frames and R lists</h3>
<p>Going back to our data set on the enegry consumption data, we see that this data set stores values of different types, characters, integers and doubles. How does R achieve this?</p>
<p>The answer is that this is achieved by a data structure called a <strong>list</strong>. List are like atomic vectors, because the group data into a one-dimensional set. However, lists do not group together individual values. List group together R objects, such as atomic vectors or even other lists.</p>
<p>For example, you can create a list, which contains a numeric vector of length 31 in its first element, a character vector of length 1 in its second element and a new list of length 2 in its third. This is done by using the <code>list()</code>function of R, like this:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>list_example <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="dv">100</span><span class="sc">:</span><span class="dv">130</span>, <span class="st">"R"</span>, <span class="fu">list</span>(<span class="cn">TRUE</span>, <span class="cn">FALSE</span>))</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>list_example</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
 [1] 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128
[30] 129 130

[[2]]
[1] "R"

[[3]]
[[3]][[1]]
[1] TRUE

[[3]][[2]]
[1] FALSE</code></pre>
</div>
</div>
<p>The double bracketed indices tell you which element of the list is being displayed. The single bracketed indices tell you which sub-element of the list is being displayed. For example 100 is the first sub element of the first element in the list. “R” is the first sub element of the second list element.</p>
<p>There is lots to say about lists. But this is an advanced topics. We mentioned it here to introduce one of the most important data structres for our course the R dataframe.</p>
</section>
<section id="data-frames" class="level3" data-number="3.2.4">
<h3 data-number="3.2.4" class="anchored" data-anchor-id="data-frames"><span class="header-section-number">3.2.4</span> Data Frames</h3>
<p><strong>Data Frames</strong> are the two dimensional version of a list. They are by far the most useful storage structure for data analysis. Indeed, our dataset on energy consumption data we have loaded before is an instance of a data frame. Data frames group vectors together in a two dimensional table. As a consequence each variable can have a different type, i.e.&nbsp;each column of the data frame can contain a different data type. Within a column, however, we can have only one data type. The energy consumption data are a typical example of a dataframe.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(energy_consumption, <span class="at">n =</span> <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>        Entity Code Year      Cons
1  Afghanistan  AFG 1980  583.2944
2  Afghanistan  AFG 1981  666.3782
3  Afghanistan  AFG 1982  725.6599
4  Afghanistan  AFG 1983  912.1396
5  Afghanistan  AFG 1984  941.3926
6  Afghanistan  AFG 1985  939.6124
7  Afghanistan  AFG 1986  976.6691
8  Afghanistan  AFG 1987 1592.7023
9  Afghanistan  AFG 1988 2805.6096
10 Afghanistan  AFG 1989 2700.4739</code></pre>
</div>
</div>
<p>Every column in this tabular array of data can be considered as a vector.</p>
</section>
<section id="selecting-data-from-r-objects-a-toolbox." class="level3" data-number="3.2.5">
<h3 data-number="3.2.5" class="anchored" data-anchor-id="selecting-data-from-r-objects-a-toolbox."><span class="header-section-number">3.2.5</span> Selecting data from R objects: A toolbox.</h3>
<p>Asking questions about a dataframe and in particular about our energy data requires that we are able to adress particular values in the dataframe. We now learn the most important techniques to do so.</p>
<p>R has a notation system to address individual values. You write the object name first, followed by a pair of had brackets <code>[]</code>. Between the brackets goes a <code>,</code> separating row and column indices. The notation is thus like <code>energy_consumption[,]</code>.</p>
<p>When it comes to writing the indices you have six different ways to do this, all of them very simple. You can use:</p>
<ol type="1">
<li>Positive integers</li>
<li>Negative integers</li>
<li>Zero</li>
<li>Blank spaces</li>
<li>Logical values</li>
<li>Names</li>
</ol>
<p>The simplest are positive integers. When you want to extract the energy consumption in kwh per person in one year - the value of the variable Cons - you would adress for instance the 3rd value in the Cons column, which is in our case the 4th column as</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>energy_consumption[<span class="dv">3</span>,<span class="dv">4</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 725.6599</code></pre>
</div>
</div>
<p>You can - of course extract more than one value. If you write for instance</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>energy_consumption[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>,<span class="dv">4</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 583.2944 666.3782 725.6599 912.1396 941.3926</code></pre>
</div>
</div>
<p>you will get the first 5 values of the consumption numbers in the dataframe. The colon operator <code>:</code> used here is a very useful R operator. It creates sequences of whole numbers. Thus if you create a vector with the name, say <code>n10</code> containing the sequence of the first 10 whole numbers, you would write</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>n10 <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now clearly the indexing rules work in the same way as with dataframes, only that now you have only 1 dimension. Say you want to extract the first three numbers from <code>n10</code> you would write</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>n10[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1 2 3</code></pre>
</div>
</div>
<p>Note that R’s notation system is not limited to data frames. The same syntax can be used to select values from any R object, provided you supply an index for each dimension of the object. Two things have to be kept in mind. In R indexing begins at 1. In some other programming languages indexing begins at 0. The indexing convention in R is just like in linear algebra. The second thing to note is that if you select two or more columns from a data frame, R will return a new data frame, like in</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>energy_consumption[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">3</span><span class="sc">:</span><span class="dv">4</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Year     Cons
1 1980 583.2944
2 1981 666.3782
3 1982 725.6599
4 1983 912.1396
5 1984 941.3926</code></pre>
</div>
</div>
<p>R will always return a dataframe.</p>
<p>However, if you select a single column, R will return a vector:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>energy_consumption[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">4</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 583.2944 666.3782 725.6599 912.1396 941.3926</code></pre>
</div>
</div>
<p>if you prefer to get returned a data frame in this case, you have to add the argument drop = FALSE, like:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>energy_consumption[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">4</span>, drop <span class="ot">=</span> <span class="cn">FALSE</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>      Cons
1 583.2944
2 666.3782
3 725.6599
4 912.1396
5 941.3926</code></pre>
</div>
</div>
<p><strong>Negative integers</strong> work exactly opposite to positive integers. If you type:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(energy_consumption[<span class="sc">-</span><span class="dv">1</span>,<span class="dv">4</span>], <span class="at">n =</span> <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1]  666.3782  725.6599  912.1396  941.3926  939.6124  976.6691 1592.7023 2805.6096 2700.4739 2557.5864</code></pre>
</div>
</div>
<p>R will return the fourth column of the data frame <em>except</em> the first row. We just display the first 10 values using the <code>head()</code> function.</p>
<p>If you try to pair a negative and a positive integer in an index, R will return an error. However, you can use both negative and positive integers if you use them in <em>different</em> indices.</p>
<p><strong>Zero</strong> is neither positive nor negative, If you use 0 as an index, R will return nothing from a dimension with index 0. The following syntax for instance creates an empty object</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>energy_consumption[<span class="dv">0</span>,<span class="dv">0</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>data frame with 0 columns and 0 rows</code></pre>
</div>
</div>
<p><strong>Blank spaces</strong> are used if you want to ask R to select <em>every</em> value in a dimension. So for instance, if you type:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="co">#|code-fold: false</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>sel <span class="ot">&lt;-</span> energy_consumption[ , <span class="dv">4</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>R will select the entire column of energy consumption. You can check that the length of this vector is</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="co">#|code-fold: false</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(sel)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 10215</code></pre>
</div>
</div>
<p>as expected.</p>
<p><strong>Logical Values</strong> can also be used for subsetting. If you type for instance</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>energy_consumption[<span class="dv">1</span>, <span class="fu">c</span>(F,F,F,T)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 583.2944</code></pre>
</div>
</div>
<p>R will select the energy consumption value of the first observation. Note that here we used the R convention that <code>TRUE</code>and <code>T</code> as well as <code>FALSE</code>and <code>F</code> have an equivalent meaning.</p>
<p>Finally, you can ask for the elements, you want by name. On our case, you could select the first energy_consumption value by the syntax</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>energy_consumption[<span class="dv">1</span>, <span class="st">"Cons"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 583.2944</code></pre>
</div>
</div>
<p>Finally, note that two types of object in R obey an optional second system of notation. You can extract values from data frames and lists with th <code>$</code>syntax.</p>
<p>It works as follows: For example</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>test <span class="ot">&lt;-</span> energy_consumption<span class="sc">$</span>Cons</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>test[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 583.2944 666.3782 725.6599 912.1396</code></pre>
</div>
</div>
<p>would select the column of energy consumption numbers in our dataframe, save them in an object names <code>test</code>and then subsequently extract the first four values from the object.</p>
</section>
<section id="application-reproduce-our-histogram-of-primary-per-capita-energy-consumption-around-the-globe-in-2019-by-a-worked-example." class="level3" data-number="3.2.6">
<h3 data-number="3.2.6" class="anchored" data-anchor-id="application-reproduce-our-histogram-of-primary-per-capita-energy-consumption-around-the-globe-in-2019-by-a-worked-example."><span class="header-section-number">3.2.6</span> Application: Reproduce our histogram of primary per capita energy consumption around the globe in 2019 by a worked example.</h3>
<p>This was a lot of abstract and dry instruction about some data extraction tools. It will require lost of practice and concrete examples before you get some natural acquaintance with these techniques which belong to the everday routines of data analysis.</p>
<p>To see the concept in action, let me take you step by step through an example by showing you how you can produce a histogram, like we discussed in the first section of this chapter starting from the raw data.</p>
<p>We have already read the data from the csv file and stored it in an object we have called <code>energy_consumption</code>. We would like to plot a histogram of the annual per capita energy consumption in different countries around the globe for the year 2019.</p>
<p>Let us look again at the first 10 observations:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(energy_consumption, <span class="at">n =</span> <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        Entity Code Year      Cons
1  Afghanistan  AFG 1980  583.2944
2  Afghanistan  AFG 1981  666.3782
3  Afghanistan  AFG 1982  725.6599
4  Afghanistan  AFG 1983  912.1396
5  Afghanistan  AFG 1984  941.3926
6  Afghanistan  AFG 1985  939.6124
7  Afghanistan  AFG 1986  976.6691
8  Afghanistan  AFG 1987 1592.7023
9  Afghanistan  AFG 1988 2805.6096
10 Afghanistan  AFG 1989 2700.4739</code></pre>
</div>
</div>
<p>How would we extract the observations that refer to the year 2019 only? Here is the first practical use case of logical data types, which will immediately show you their power. Let me suggest the following code and then explain step by step what it does.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> energy_consumption[energy_consumption<span class="sc">$</span>Year <span class="sc">==</span> <span class="dv">2019</span>, ]</span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(dat, <span class="at">n =</span> <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                 Entity Code Year       Cons
40          Afghanistan  AFG 2019   945.6454
95               Africa      2019  4245.7188
137             Albania  ALB 2019 11266.2578
192             Algeria  DZA 2019 16140.1963
234      American Samoa  ASM 2019 26023.6699
274              Angola  AGO 2019  3429.5928
314 Antigua and Barbuda  ATG 2019 31384.8633
369           Argentina  ARG 2019 20785.9141
399             Armenia  ARM 2019 15538.2012
433               Aruba  ABW 2019 51178.5859</code></pre>
</div>
</div>
<p>Let me explain what is going on here: We have used the indexing rules and logical subsetting. In the first index we have written a logical condition, namely <code>energy_consumption$Year == 2019</code>. This means that R selects all the rows for which the year variable of energy_consumption is equal to 2019. The logical sign for identical in R is <code>==</code>. So what R does then is checking for each value of the Year variable whether it is identical to 2019 - in which case the logical comparison results in <code>TRUE</code> or not, in which case the result would be <code>FALSE</code>. Then by logical subsetting all rows for which the comparison vector is <code>TRUE</code> will be selected. Note that we had to tell R that it needs to compare the Year variable. Year is selected in a data frame by <code>energy_consumption$Year</code>. We have then stored all the data in a vector I have called dat and then looked at the first 10 rows. You see that only the observations where the Year is 2019 have been kept, as we had intended.</p>
<p>Now we see from the output that the <code>Entity</code> variable apparently not only contains individual countries but also whole regions or continents, like <code>Africa</code> in our example. It seems that the regions have no ISO code but instead an empty character.</p>
<p>Let’s try to apply the logical subsetting logic and our knowledge of character types to filter out Entities which have no value in the <code>Code</code>variable. One way to achieve this would be, for example the code:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>dat_countries <span class="ot">&lt;-</span> dat[dat<span class="sc">$</span>Code<span class="sc">!=</span><span class="st">""</span>, ]</span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(dat_countries, <span class="at">n =</span> <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                 Entity Code Year       Cons
40          Afghanistan  AFG 2019   945.6454
137             Albania  ALB 2019 11266.2578
192             Algeria  DZA 2019 16140.1963
234      American Samoa  ASM 2019 26023.6699
274              Angola  AGO 2019  3429.5928
314 Antigua and Barbuda  ATG 2019 31384.8633
369           Argentina  ARG 2019 20785.9141
399             Armenia  ARM 2019 15538.2012
433               Aruba  ABW 2019 51178.5859
545           Australia  AUS 2019 66614.8828</code></pre>
</div>
</div>
<p>Now Africa is out. Of course this is no proof that I have now only entities with ISO-codes left but it is an indication. We can check this. But let me first expalin what is going on here.</p>
<p>I now work with the object <code>dat</code>, the object we have created before by filtering for the observations in which the <code>Year</code>variable is equal to 2019. Now we tell R compare the entries in the <code>Code</code>variable, i.e. in <code>dat$code</code> with the condition that they are not equal to an empty string. The symbol for <code>not identical</code> in R is <code>!=</code>. We know that the variable <code>Code</code> is of type character hence all codes are strings within quotation marks. An empty string is thus written as <code>" "</code>.</p>
<p>How could we check - by the way that the <code>Code</code> variable does not contain any empty string anymore? Here is how:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(dat_countries<span class="sc">$</span>Code <span class="sc">==</span> <span class="st">""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
</div>
<p>Here I have used two rules we have dicussed before, logical data types and coercion. First we ask R to check whether any Code variable in <code>dat_counties</code>still has any empty string. This will create a vector of logicals like (showing only the first five entries)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(dat_countries<span class="sc">$</span>Code <span class="sc">==</span> <span class="st">""</span>, <span class="at">n =</span> <span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] FALSE FALSE FALSE FALSE FALSE</code></pre>
</div>
</div>
<p>Now I use coercion rules by summing over this vector. The function <code>sum()</code> in R is a function for summation. For example, if I have the vector <code>c(1,2,3,4,5,6,7,8,9,10)</code> and type</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">9</span>,<span class="dv">10</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 55</code></pre>
</div>
</div>
<p>R will add up the numbers.</p>
<p>Now if I have a vector of logicals and apply a numerical function to it, R will by its coercion rules, force <code>TRUE</code> into 1 and <code>FALSE</code> into 0. The result that <code>sum(dat_countries$Code == "")</code> equals 0 means that the vector for our logical test contained <code>FALSE</code> only. So indeed there is no empty <code>Code</code> variable anymore.</p>
<p>Now we are ready to do a histogram of the per capita primary annual energy consumption by</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(dat_countries<span class="sc">$</span>Cons, </span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Primary energy consumption in kilowatt-hours per person per year."</span>,</span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Primary energy Consuption per Capita 2019"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="summarizing_and_communicating_lots_of_data_files/figure-html/unnamed-chunk-45-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>I have here used the <code>xlab</code>and <code>main</code>arguments with a character value to have a nicer description of the histogram. Otherwise the x axis would have been labeled <code>dat_countries$Cons</code> and the title would have been <code>Histogram of dat_countries$Cons</code>. Note that we have here a histogram in the absolute frequency scale.</p>
</section>
</section>
<section id="the-average-and-the-standard-deviation" class="level2 page-columns page-full" data-number="3.3">
<h2 data-number="3.3" class="anchored" data-anchor-id="the-average-and-the-standard-deviation"><span class="header-section-number">3.3</span> The average and the standard deviation</h2>
<p>With a histogram we can summarize a large amount of data and get some insights about the variation in the data. Often we can summarize data much more drastically by just one number describing the center of the histogram and the spread around this center. When I write center an spread here, these are just ordinary words with no special technical meaning.</p>
<p>When we do statistics we need precise definitions and we will study and learn these definitions in this section. The <strong>average</strong> is often used to find the center. Another measure to find the center is the <strong>median</strong>. The <strong>standard</strong> deviation measures spread around the average. The <strong>interquartile range</strong> is another measure of spreads.</p>
<p>Before we go into these definitions, let me show for a start two histograms, both have the same center, but the second one is more spread out, there are more observations farther away from the center.</p>
<div id="fig-example-hist" class="quarto-layout-panel">
<figure class="figure">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-ex-hist-1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="pictures/example_histogram1.png" class="img-fluid figure-img" data-ref-parent="fig-example-hist"></p>
<figcaption class="figure-caption">(a) Histogram 1</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-ex-hist-2" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="pictures/example_histogram2.png" class="img-fluid figure-img" data-ref-parent="fig-example-hist"></p>
<figcaption class="figure-caption">(b) Histogram 2</figcaption>
</figure>
</div>
</div>
</div>
<p></p><figcaption class="figure-caption">Figure&nbsp;3.3: Histogram 1 and Histogram 2 have the same center but Histogram 2 is more spread out</figcaption><p></p>
</figure>
</div>
<p>These distributions can be summarized by the center and the spread. But what about a situation like this?</p>
<div id="fig-ex-hist-bm" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="pictures/bimodal.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Figure&nbsp;3.4: A bimodal distribution</figcaption>
</figure>
</div>
<p>In some cases such distribution can occur naturally. Think, for example, about the distribution of the elevation data of surface area of the earth. Most of the surface area of the earth is taken by the sea floor at about three miles below the sea level or the continental planes around sea level. If we would report only the center an the spread of this histogram, plotted in the picture as the red and blue vertical lines, we would miss these peaks.</p>
<section id="the-average" class="level3 page-columns page-full" data-number="3.3.1">
<h3 data-number="3.3.1" class="anchored" data-anchor-id="the-average"><span class="header-section-number">3.3.1</span> The average</h3>
<p>Human growth depends on good nutrition and the availability of medical services to effectively treat illness. Thus human height in a population has for a long time been a subject of study. The average human height in a population varies with the general living standards. In statistical terminology this is expressed by saying that human height and growth are positively correlated. This fact makes data on human height especially interesting for historians who study the history of living conditions. Because humans tend to get taller when they have good living conditions, human height can reveal some information on living conditions, height data can be an indirect measure of living conditions. This is especially interesting for periods when very little or no data were collected and recorded.</p>
<p>As we see from the class activity in the introductory unit where we collected data in your class on height and hand span, we learned that usually heights differ quite a bit within a group. This is also true in a population. The many different height data, which are usually collected in survey studies on health are usually summarized by studying average height. Height data are thus also interesting for us as one specific context to study height data.</p>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Average
</div>
</div>
<div class="callout-body-container callout-body">
<p>The average of a list of numbers is defined as their sum, divided by how many numbers their are in the list.</p>
</div>
</div>
<p>For example the average of the list <span class="math inline">\(L\)</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>L <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">9</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>would be computed as:</p>
<p><span class="math display">\[\begin{equation}
\frac{(9+1+2+2+0)}{5} = \frac{14}{5} = 2.8
\end{equation}\]</span></p>
<p>By now it will be no surprise for you that R provides a function for computing averages. This function is known by the alternative name for the average, called the mean.</p>
<p>Here is how you would compute the mean using R.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(L)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2.8</code></pre>
</div>
</div>
<p>which is indeed what we should get as a result.</p>
<div class="page-columns page-full"><p>Let’s go back to the issue of human height data. Let us first look at a sample of height data and how they look like. This is a data set from the statistics Online Computational Resource (SOCR) of the university of California Los Angeles.<a href="#fn9" class="footnote-ref" id="fnref9" role="doc-noteref"><sup>9</sup></a> for details.] The dataset contains 25,000 synthetic records of human heights and weights of 18 years old children.</p><div class="no-row-height column-margin column-container"><li id="fn9"><p><sup>9</sup>&nbsp;See http://www.socr.ucla.edu/</p></li></div></div>
<p>Let us look at the histogram first. But before we do this, let me briefly explain a feature of R that will be very useful for us in the remainder of this course.</p>
<section id="a-brief-digression-installing-and-using-r-packages" class="level4 page-columns page-full" data-number="3.3.1.1">
<h4 data-number="3.3.1.1" class="anchored" data-anchor-id="a-brief-digression-installing-and-using-r-packages"><span class="header-section-number">3.3.1.1</span> A brief digression: Installing and using R packages</h4>
<p>When we install R we get a version the program which is called <code>base-r</code>. This is the term for the basic version, which comes with any R installation. The base version contains all the important functions. The <code>hist()</code>function is part of <code>base-r</code> for example, but also <code>mean()</code>, <code>lenght()</code> etc.</p>
<p>Base R can be extended by adding so called packages. A package contains additional functions for doing computations or other things like graphics with R written by other people or by yourself, once you have learned how to write a package. Packages have to be installed and then they need to be loaded to make the functions of the package available to R. You have to install a new package only once, but you have to load it in every new session of R if you want to use it.</p>
<p>The first package, you will encounter in this course is a package that I have prepared when preparing the course. It contains all the data sets we use here. When the package is loaded these data sets are available for use. The package that contains our data is called <code>JWL</code>. You need to install it first. As you might guess there is an R function to install packages. The function is called <code>install.packages()</code>. This function works if the package is beeing made available via the R CRAN-server at https://cran.r-project.org/. Our package is a package that I have assembled for this course and it was installed from a private archive. It is not on CRAN. For you taking this course the package is already installed.</p>
<p>To be able to make the funcions and the data contained in the package available to R you need to laod the package first. This is done with the function <code>library()</code>. Now assume we want to load the package <code>JWL</code> we need to type</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(JWL)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now all the datasets bundled in the JWL-package are available for use to you. This includes the data sets on human height data I have prepared for this course.</p>
<p>The data set is called <code>socr_height_weight</code> and you can study the details and description of the data by typing <code>?socr_height_weight</code> at the prompt.</p>
<p>Let us start by first saving the <code>socr_height_weight</code> data in an R object which we call - say - <code>´dat</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> socr_height_weight</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We can inspect the R object, using the R function <code>str()</code>. This function compactly displays the internal structure of an R object.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(dat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   25000 obs. of  3 variables:
 $ Index : num  1 2 3 4 5 6 7 8 9 10 ...
 $ Height: num  65.8 71.5 69.4 68.2 67.8 ...
 $ Weight: num  113 136 153 142 144 ...</code></pre>
</div>
</div>
<p>We see that <code>dat</code> is a data frame with three variables Index, Height and Weight. All variables are of type numeric.</p>
<p>From the help information on the dataset we know that the units of the Height variable is inches. Inches are used in the English speaking countries but in many other parts of the world the more common units are metric units. Human height in metric units would be measured in cm rather than in inches. This is an excellent opportunity to practice some of the R knowlegde you have learned in this unit.</p>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Now you try
</div>
</div>
<div class="callout-body-container callout-body">
<p>The variable <code>Height</code> in the dataframe <code>dat</code> is measured in inches. 1 inch is 2.54 cm. Transform the Height variable such that it shows the Height in cm rather than in inches,</p>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="co"># the hight data are in inches and the weight data are in pounds. Convert to metric</span></span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a><span class="co"># units cm</span></span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a>dat<span class="sc">$</span>Height <span class="ot">&lt;-</span> dat<span class="sc">$</span>Height<span class="sc">*</span><span class="fl">2.54</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Once you have done this little transformation of units, let us plot a histogram first. Let us also lable the x-axes as “Height in cm” and write as a title of the histogram “Height of 18 year old humans”</p>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Now you try
</div>
</div>
<div class="callout-body-container callout-body">
<p>Use R to plot a histogram of the Height variabe in the dat dataframe. Label the x-axes as “Height in cm” and write as a title of the histogram “Height of 18 year old humans”</p>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(dat<span class="sc">$</span>Height, <span class="at">xlab =</span> <span class="st">"Height in cm"</span>, <span class="at">main =</span> <span class="st">"Height of 18 year old humans"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="summarizing_and_communicating_lots_of_data_files/figure-html/unnamed-chunk-54-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The distribution looks symmetric. If we summarize these data by taking an average in one number we will capture the center of the distribution fairly well. Let us compute the average, using the mean funcion.</p>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Now you try
</div>
</div>
<div class="callout-body-container callout-body">
<p>Use R to compute the average or mean of the Height variable in the dat dataframe.</p>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(dat<span class="sc">$</span>Height)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 172.7025</code></pre>
</div>
</div>
<p>The average height in this dataset is about 173 cm. The average is a very powerful way of communicating data by compressing many observations - in this example 25000 - into ons single number, the mean.</p>
<p>This compression is, however, only achieved by loosing some information on individual differences. For example in our dataset the average height is 173 cm. But there are about 4 % who are larger than 180.9 and there are also about 4 % who are smaller than 164.2. With 25000 individuals these are 1000 individuals who are beyond these thresholds. This diversity is hidden in the aggregation.</p>
<p>This is a good opportunity to show you a cool feature or trick in R how we could in one line compute such percentages. Assume we want to compute the percentage of individuals in our data who are larger than the mean of 172.7025. How can we do this?</p>
<p>Logicals are a powerful data type to make such a computation. Say we have 10 numbers, given by</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">10</span>,<span class="dv">11</span>,<span class="dv">6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now we could ask R which entries of x are larger than 2 by typing</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a>x <span class="sc">&gt;</span> <span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1]  TRUE  TRUE FALSE FALSE  TRUE FALSE FALSE  TRUE  TRUE  TRUE</code></pre>
</div>
</div>
<p>The output is a vector of logicals where R compares each entry in <code>x</code>with 2 and if it is larger it returns <code>TRUE</code> and otherwise <code>FALSE</code> (this includes all entries which are exactly 2).</p>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Now you try
</div>
</div>
<div class="callout-body-container callout-body">
<p>Replace every <code>TRUE</code> value with 1 and every <code>FALSE</code> value with 0 and compute the mean. What do you get? Compute the percentage of values in <code>x</code>which are larger than 2. What did you get? Explain!</p>
</div>
</div>
<p>Note that, when you apply the function <code>mean()</code> to a vector of data of type logical the coercion rules of R will coerce TRUE to 1 and FALSE to 0 automatically. So if you apply <code>mean()</code> to <code>x</code> you will get the result you have computed before.</p>
<p>This insight can be used to compute the percentage of values that fulfill a certain condition in R. Here the condition is that the Height is larger than the mean.</p>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Now you try
</div>
</div>
<div class="callout-body-container callout-body">
<p>Compute the percentage of Heights in <code>dat</code> which are larger and the percentage of Heights that are smaller than the mean of 172.7025.</p>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(dat<span class="sc">$</span>Height <span class="sc">&gt;</span> <span class="fl">172.7025</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.5006</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(dat<span class="sc">$</span>Height <span class="sc">&lt;</span> <span class="fl">172.7025</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.4994</code></pre>
</div>
</div>
<p>The value of a distribution where 50 % of all values are larger than this given value and 50 % are smaller is another one number summary you can give for a large set of data which describes the center of a distribution in another way. It is called the median. R also has a built in function for the median, which is called - as you might already guess - <code>median()</code>. Let us compute the median height in our data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="fu">median</span>(dat<span class="sc">$</span>Height)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 172.7091</code></pre>
</div>
</div>
<p>In this case the median and the mean give the same value up to the third digit. They are for practical reasons identical. The reason is that in the case of the measure of Height the distribution is highly symmetric. In practice you will encounter many situations where the distribution of a variable is not even approximately symmetric.</p>
<div class="page-columns page-full"><p>A typical case of a distribution that us typically not symmetric but skewed - as it is called in statistical terminology - is income. The following histogram which is scaled in relative frequencies shows the data for the global income distribution in the year 2013 as reported by two economists <span class="citation" data-cites="HelMau2015">Hellebrand and Mauro (<a href="references.html#ref-HelMau2015" role="doc-biblioref">2015</a>)</span> from the Peterson Institute, a US based research institution.<a href="#fn10" class="footnote-ref" id="fnref10" role="doc-noteref"><sup>10</sup></a> The unit of measurement is US dollars in so called purchasing power parity, a concept economists use to make income figures comparable in terms of the amount of goods they can buy.<a href="#fn11" class="footnote-ref" id="fnref11" role="doc-noteref"><sup>11</sup></a></p><div class="no-row-height column-margin column-container"><li id="fn10"><p><sup>10</sup>&nbsp;We have used the data they provide to simulate a sample of 100.000 observations consisten with the numbers they report. Thus our data used here are a simulation reproducing the characteristics of the data reported in this paper. We will soon learn how to do simulations using R. For the moment we need you to trust that we have done this correctly.</p></li><li id="fn11"><p><sup>11</sup>&nbsp;When reporting income figures we could translate all national figures gathered from around the world into one common currency (for instance, US dollars) using exchange rates from currency markets. But because market exchange rates do not always reflect the different price levels between countries, economists often opt for a different alternative. They create a hypothetical currency, called ‘international dollars’, and use this as a common unit of measure. The idea is that a given amount of international dollars should buy roughly the same amount – and quality – of goods and services in any country. This way of measuring monetary amounts is called dollars in purchasing power parity or PPP.</p></li></div></div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a>aux <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"~/R/Statistics_JWL/data/income/wp15-7.xlsx"</span>, <span class="at">sheet =</span> <span class="dv">5</span>, <span class="at">range =</span> <span class="st">"B1:D1401"</span>)</span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a>inc <span class="ot">&lt;-</span> aux[<span class="sc">-</span><span class="dv">1</span> ,<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>)]</span>
<span id="cb107-4"><a href="#cb107-4" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(inc) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Income"</span>, <span class="st">"Percent"</span>)</span>
<span id="cb107-5"><a href="#cb107-5" aria-hidden="true" tabindex="-1"></a>inc<span class="sc">$</span>Income <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">unlist</span>(inc<span class="sc">$</span>Income))</span>
<span id="cb107-6"><a href="#cb107-6" aria-hidden="true" tabindex="-1"></a>inc<span class="sc">$</span>Percent <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">unlist</span>(inc<span class="sc">$</span>Percent))</span>
<span id="cb107-7"><a href="#cb107-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-8"><a href="#cb107-8" aria-hidden="true" tabindex="-1"></a>inc_trunc <span class="ot">&lt;-</span> inc<span class="sc">$</span>Income[inc<span class="sc">$</span>Income<span class="sc">&lt;=</span><span class="dv">14000</span>]</span>
<span id="cb107-9"><a href="#cb107-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-10"><a href="#cb107-10" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">sample</span>(inc_trunc, <span class="dv">10</span><span class="sc">^</span><span class="dv">5</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>, <span class="at">prob =</span> inc<span class="sc">$</span>Percent[<span class="dv">0</span><span class="sc">:</span><span class="dv">701</span>])</span>
<span id="cb107-11"><a href="#cb107-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-12"><a href="#cb107-12" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(data, <span class="at">breaks =</span> <span class="dv">27</span>, <span class="at">xlab =</span> <span class="st">"Income in purchasing parity power dollars"</span>, <span class="at">main =</span> <span class="st">"Global income distribution"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="summarizing_and_communicating_lots_of_data_files/figure-html/unnamed-chunk-60-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Now the mean and the median of these data would give us:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3012.174</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="fu">median</span>(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1700</code></pre>
</div>
</div>
<p>There is a big difference in both numbers as you can see even better when we show the mean (red line) and the median (blue) income value of our data in the graph.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(data, <span class="at">breaks =</span> <span class="dv">27</span>, <span class="at">xlab =</span> <span class="st">"Income in purchasing parity power dollars"</span>, <span class="at">main =</span> <span class="st">"Global income distribution"</span>)</span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="fu">mean</span>(data),                       <span class="co"># Add red line for mean</span></span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="st">"red"</span>)</span>
<span id="cb112-4"><a href="#cb112-4" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="fu">median</span>(data),                     <span class="co"># Add blue line for median</span></span>
<span id="cb112-5"><a href="#cb112-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="st">"blue"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="summarizing_and_communicating_lots_of_data_files/figure-html/unnamed-chunk-62-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>When the distribution is not symmetric the mean does not capture the center of the distribution well. We have stored the data of our histogram in an object we have chosen to call <code>data</code>. Let us verify that the median is actually the value above that is in the middle of all values and compare this with the mean for these skewed distribution.</p>
<p>Let’s check the median first</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(data <span class="sc">&gt;</span> <span class="dv">1700</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.49616</code></pre>
</div>
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(data <span class="sc">&lt;</span> <span class="dv">1700</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.49998</code></pre>
</div>
</div>
<p>Now let us do the same check for the mean</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(data <span class="sc">&gt;</span> <span class="fl">3012.174</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.32447</code></pre>
</div>
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(data <span class="sc">&lt;</span> <span class="fl">3012.174</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.67553</code></pre>
</div>
</div>
<p>You see that the mean now does not capture the center of the distribution well. Only 32 % have incomes above the mean income and 68 % have incomes below. The point where 50% are above and 50 % are below is actually at 1700, as expressed by the median.</p>
<p>There is another important difference between the mean and the median. Let us illustrate this difference with the example of primary energy consumption across the countries in the world. This distribution turned out to be highly skewed. Remember the histogram</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(dat_countries<span class="sc">$</span>Cons, </span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Primary energy consumption in kilowatt-hours per person per year."</span>,</span>
<span id="cb121-3"><a href="#cb121-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Primary energy Consuption per Capita 2019"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="summarizing_and_communicating_lots_of_data_files/figure-html/unnamed-chunk-65-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The mean is:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(dat_countries<span class="sc">$</span>Cons)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 26767.75</code></pre>
</div>
</div>
<p>and the median is</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="fu">median</span>(dat_countries<span class="sc">$</span>Cons)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 16525.11</code></pre>
</div>
</div>
<p>Now let us assume we add a fictitious large value to the data set, say 400.000 kwh per person per year and recalculate the mean.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="fu">c</span>(dat_countries<span class="sc">$</span>Cons, <span class="dv">400000</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 28479.82</code></pre>
</div>
</div>
<p>Now the mean per capita consumption is quite a bit larger actually - just from this one extreme observation - it is larger by more than 6 %.</p>
<p>What happens to the median?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a><span class="fu">median</span>(<span class="fu">c</span>(dat_countries<span class="sc">$</span>Cons, <span class="dv">400000</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 16525.53</code></pre>
</div>
</div>
<p>It stays about the same.</p>
<p>The take away here is that the mean is a summary measure that is sensitive to outliers. The median on the other hand is a more robust measure. One or a a few outliers can not move the median.</p>
</section>
</section>
<section id="exercises-for-the-average" class="level3" data-number="3.3.2">
<h3 data-number="3.3.2" class="anchored" data-anchor-id="exercises-for-the-average"><span class="header-section-number">3.3.2</span> Exercises for the Average</h3>
<p>Exercise 1:</p>
<ol type="a">
<li><p>The number 3 and 5 are marked by crosses on the horizontal line below. Find the average of these two numbers and mark it by an arrow.</p>
<p><img src="pictures/average_a.png" class="img-fluid"></p></li>
<li><p>Repeat (a) for the list 3,5,5</p>
<p><img src="pictures/average_b.png" class="img-fluid"></p></li>
<li><p>Two numbers are shown below by crosses on a horizontal axis. Draw an arrow pointing to their average.</p>
<p><img src="pictures/average_c.png" class="img-fluid"></p></li>
</ol>
<p>Exercise 2:</p>
<p>A list has 10 entries. Each entry is either 1, 2 or 3. What must the list be of the average is 1? if the average is 3? Can the average be 4?</p>
<p>Exercise 3:</p>
<p>Which of the following lists has a bigger average? Or are they the same? try to answer without doing arithmetic.</p>
<ol type="i">
<li>10, 7, 8, 3, 5, 9 (ii) 10, 7, 8, 3, 5, 9, 11</li>
</ol>
<p>Exercise 4:</p>
<p>Ten people in a room have an average height of 1.69 m. An 11th person is 1.96 enters the room. Find the average height of all 11 people.</p>
<p>Exercise 5:</p>
<p>Twenty-one people in a room have an average height of 1.68. A 22nd person who is 1.96 enters the room. Find the average height of all 22 people. Compare with exercise 4.</p>
<p>Exercise 6:</p>
<p>Twenty-one people in a room have a height of 1.68. A 22nd person enters the room. How tall would he have to be to raise the average height by 1 inch.</p>
<p>Exercise 7:</p>
<p>If you go back to figure <a href="#fig-ex-hist-bm">Figure&nbsp;<span>3.4</span></a>, where in the Histogram would be mountains? Where would you find planes? Where would the trenches in the sea floor show?</p>
<p>Exercise 8:</p>
<p>Diastolic blood pressure is considered a better indicator of heart trouble than systolic pressure. The figure below shows age-specific average diastolic blood pressure for men age 20 and over in a health survey from the US (HANES5 (2003-04)). True or fales: The data show that as men age, their diastolic blood pressure increases until age 45 or so. and then decreases. If false, how do you explain the pattern in the graph? (Blood pressure is measured in “mm” that is millimeter of mercury)</p>
<p><img src="pictures/blood_pressure.png" class="img-fluid"></p>
<p>Exercise 9:</p>
<p>Average hourly earnings in the US are computed each month by the Bureau fo Labor statistics using payroll data from commercial establishments. The Bureau figures the total wages paid out to non-supervisory personnel, and divides by the total hours worked. During recessions, average hourly earnings typically go up. When the recession ends, average hourly earnings often start going down. How can this be?</p>
</section>
<section id="the-standard-deviation" class="level3" data-number="3.3.3">
<h3 data-number="3.3.3" class="anchored" data-anchor-id="the-standard-deviation"><span class="header-section-number">3.3.3</span> The standard deviation</h3>
<p>When summarizing and communicating lots of data, it is useful not only to report at which value the center of the distribution is. It is often helpful to also think about the way how the values spread around the average. The quantity which measures this spread is called the standard deviation. It can be interpreted as an average deviation. In this section you will learn to interpret the standard deviation in the context of real data and then learn how it is computed both by hand and by using the computer.</p>
<p>Le us go back to our data on the height of 18 year old humans. There were 25.000 observations in our sample. The average height was</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(dat<span class="sc">$</span>Height)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 172.7025</code></pre>
</div>
</div>
<p>This average tells us that most of the humans measured in the sample had a height of around 1 m and 73 cm. But there were deviations from this average. Some humans were taller and others were smaller. We can ask how big these deviations are? In answering this question we need the concept of the standard deviation.</p>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Standard deviation
</div>
</div>
<div class="callout-body-container callout-body">
<p>The standard deviation says how far away numbers on a list are from their average. Most entries on the list will usually be somewhat around one standard deviation from the average. Very few will be more than two or three standard deviations away.</p>
</div>
</div>
<p>In R you can compute the standard deviation by using the function <code>sd()</code>. So let us compute the standard deviation of our height data using the <code>sd()</code>function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(dat<span class="sc">$</span>Height)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4.830264</code></pre>
</div>
</div>
<p>So the standard deviation is at about 4.8 cm. That means that many humans differed from the average height by about 1, 2, 3, 4 or about 5 cm. Let us use R to compute the percent of observation that are within one standard deviation from the average.</p>
<p>Let us use the trick of combining logical subsetting and the coercion rules of R to compute this percentage here:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a>aux <span class="ot">&lt;-</span> dat<span class="sc">$</span>Height <span class="sc">&gt;=</span> <span class="fu">mean</span>(dat<span class="sc">$</span>Height) <span class="sc">-</span> <span class="fu">sd</span>(dat<span class="sc">$</span>Height) <span class="sc">&amp;</span> dat<span class="sc">$</span>Height <span class="sc">&lt;=</span> <span class="fu">mean</span>(dat<span class="sc">$</span>Height) <span class="sc">+</span> <span class="fu">sd</span>(dat<span class="sc">$</span>Height)</span>
<span id="cb134-2"><a href="#cb134-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb134-3"><a href="#cb134-3" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(aux)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.68356</code></pre>
</div>
</div>
<p>Let me explain what we have computed here. First we have checked for all the entries in the vector <code>dat$Height</code> whether they were larger than the average minus one standard deviation and smaller than the average plus one standard deviation. These are all the values that are within one standard deviation away from the average. For all values that are in this range R returns the value <code>TRUE</code> and for all the other values that are outside of this range, R returns the value <code>FALSE</code>. We have stored the vector recording all these logical values in a new object called <code>aux</code>. Now we computed the mean of aux. When the mean function of R gets a vector of logical values it coerces all the <code>TRUE</code> values to 1 and al the <code>FALSE</code> values to 0. When we take the mean we get the share of values for which the condition is TRUE. In our case this is around 68 %. The other 32 % are farther away.</p>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Now you try
</div>
</div>
<div class="callout-body-container callout-body">
<ol type="1">
<li><p>Compute the percentage of observations of our height data that are within two standard deviations from the average.</p></li>
<li><p>Compute the percentage of observations of our height data that are within three standard deviations from the average.</p></li>
</ol>
</div>
</div>
<p>This is a rule of thumb that applies to many (but not all) data sets. For many distributions roughly 68 % of observations are within one standard deviation from the average. 95 % are within two standard deviations from the average and 99.7 % are within three standard deviations from the average. There is a deeper mathematical reason why this rule applies to many symmetric distributions. For the moment we can use this information as a sort of rile of thumb for symmetric, bell shaped distributions. We will learn later in the course where this rule comes from. Let us illustrate the rules graphically using the histogram.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(dat<span class="sc">$</span>Height, <span class="at">col =</span> color_list, <span class="at">xlab =</span> <span class="st">"Height in cm"</span>, <span class="at">main =</span> <span class="st">"Height of 18 year old humans"</span>)</span>
<span id="cb136-2"><a href="#cb136-2" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="fu">mean</span>(dat<span class="sc">$</span>Height),                       <span class="co"># Add red line for mean</span></span>
<span id="cb136-3"><a href="#cb136-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="st">"red"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="summarizing_and_communicating_lots_of_data_files/figure-html/unnamed-chunk-74-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The next figure shows the same histogram. Now the area within two standard deviations from the mean is colored differently</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(dat<span class="sc">$</span>Height, <span class="at">col =</span> color_list, <span class="at">xlab =</span> <span class="st">"Height in cm"</span>, <span class="at">main =</span> <span class="st">"Height of 18 year old humans"</span>)</span>
<span id="cb137-2"><a href="#cb137-2" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="fu">mean</span>(dat<span class="sc">$</span>Height),                       <span class="co"># Add red line for mean</span></span>
<span id="cb137-3"><a href="#cb137-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="st">"red"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="summarizing_and_communicating_lots_of_data_files/figure-html/unnamed-chunk-76-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Let us note a final point about this rule of thumb for symmetric distribution, you frequently encounter in practice. Often it is common to report a distribution of a variable not in its orginal units - height in cm - for example but in a standardized form where the units are changed such that the mean is at 0 and the standard deviation is at 1.</p>
<p>How is this possible? Let us consider the following example.</p>
<div class="callout callout-style-simple callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Example
</div>
</div>
<div class="callout-body-container callout-body">
<p>Consider the following 10 values, which we write into a vector <span class="math inline">\(x\)</span> and compute its mean <span class="math inline">\(\mu\)</span> and its standard deviation <span class="math inline">\(\sigma\)</span>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">9</span>,<span class="dv">14</span>,<span class="dv">9</span>,<span class="dv">11</span>,<span class="dv">11</span>,<span class="dv">10</span>,<span class="dv">15</span>,<span class="dv">8</span>,<span class="dv">11</span>,<span class="dv">13</span>)</span>
<span id="cb138-2"><a href="#cb138-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-3"><a href="#cb138-3" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 11.1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2.282786</code></pre>
</div>
</div>
<p>Thus <span class="math inline">\(\mu = 11.1\)</span> and <span class="math inline">\(\sigma = 2.282786\)</span>. Now let us change the units according to the formula <span class="math display">\[\begin{equation*}
z_i = \frac{x_i - \mu}{\sigma}
\end{equation*}\]</span> and compute the mean of <span class="math inline">\(z_i\)</span> and its standard deviation. We can use R to do that:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb142"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> (x <span class="sc">-</span> <span class="fu">mean</span>(x))<span class="sc">/</span><span class="fu">sd</span>(x)</span>
<span id="cb142-2"><a href="#cb142-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-3"><a href="#cb142-3" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(z)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.422473e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb144"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(z)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1</code></pre>
</div>
</div>
<p>Now you see that the mean is 0 and the standard deviation is 1. The mean in the R computation is not exactly 0, but this comes from the rounding errors made by the computer. For practical purposed <span class="math inline">\(1.4 \times 10^{-16}\)</span> is as good as zero. This must be the case as a consequence of how we changed the units. The mathematically inclined among you might try to derive this fact more generally using the definition of the mean and the standard deviation.</p>
<p>Now see what happens when we standardize our height data</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb146"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a><span class="co">#|code-fold: false</span></span>
<span id="cb146-2"><a href="#cb146-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-3"><a href="#cb146-3" aria-hidden="true" tabindex="-1"></a>dat<span class="sc">$</span>Z <span class="ot">&lt;-</span> (dat<span class="sc">$</span>Height <span class="sc">-</span> <span class="fu">mean</span>(dat<span class="sc">$</span>Height))<span class="sc">/</span><span class="fu">sd</span>(dat<span class="sc">$</span>Height)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>We want to see how many of the transformed values fall within 1 standard deviation, 2 standard deviations or three standard deviations from the mean.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb147"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a>check1 <span class="ot">&lt;-</span> dat<span class="sc">$</span>Z <span class="sc">&gt;=</span> <span class="fu">mean</span>(dat<span class="sc">$</span>Z) <span class="sc">-</span> <span class="fu">sd</span>(dat<span class="sc">$</span>Z) <span class="sc">&amp;</span> dat<span class="sc">$</span>Z <span class="sc">&lt;=</span> <span class="fu">mean</span>(dat<span class="sc">$</span>Z) <span class="sc">+</span> <span class="fu">sd</span>(dat<span class="sc">$</span>Z)</span>
<span id="cb147-2"><a href="#cb147-2" aria-hidden="true" tabindex="-1"></a>check2 <span class="ot">&lt;-</span> dat<span class="sc">$</span>Z <span class="sc">&gt;=</span> <span class="fu">mean</span>(dat<span class="sc">$</span>Z) <span class="sc">-</span> <span class="dv">2</span><span class="sc">*</span><span class="fu">sd</span>(dat<span class="sc">$</span>Z) <span class="sc">&amp;</span> dat<span class="sc">$</span>Z <span class="sc">&lt;=</span> <span class="fu">mean</span>(dat<span class="sc">$</span>Z) <span class="sc">+</span> <span class="dv">2</span><span class="sc">*</span><span class="fu">sd</span>(dat<span class="sc">$</span>Z)</span>
<span id="cb147-3"><a href="#cb147-3" aria-hidden="true" tabindex="-1"></a>check3 <span class="ot">&lt;-</span> dat<span class="sc">$</span>Z <span class="sc">&gt;=</span> <span class="fu">mean</span>(dat<span class="sc">$</span>Z) <span class="sc">-</span> <span class="dv">3</span><span class="sc">*</span><span class="fu">sd</span>(dat<span class="sc">$</span>Z) <span class="sc">&amp;</span> dat<span class="sc">$</span>Z <span class="sc">&lt;=</span> <span class="fu">mean</span>(dat<span class="sc">$</span>Z) <span class="sc">+</span> <span class="dv">3</span><span class="sc">*</span><span class="fu">sd</span>(dat<span class="sc">$</span>Z)</span>
<span id="cb147-4"><a href="#cb147-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb147-5"><a href="#cb147-5" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(check1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.68356</code></pre>
</div>
<div class="sourceCode cell-code" id="cb149"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(check2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9546</code></pre>
</div>
<div class="sourceCode cell-code" id="cb151"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(check3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.99796</code></pre>
</div>
</div>
</div>
</div>
<p>So the rule of thumb applies all the same: About 65 % of observations are within one standard deviation from the mean, 95 % within 2 and 99.7 within three standard devaitions. The transformation has only changed the units in which we measure our values not the way they are distributed.</p>
</section>
<section id="exercises-for-the-standard-deviation" class="level3" data-number="3.3.4">
<h3 data-number="3.3.4" class="anchored" data-anchor-id="exercises-for-the-standard-deviation"><span class="header-section-number">3.3.4</span> Exercises for the standard deviation</h3>
<p>Exercise 1:</p>
<p>The <code>socr_height_weight</code> about the height and weight of 18 year old humans, we had used in the lecture before the average height in inches was about 173 cm and the standard deviation was about 5 cm.</p>
<ol type="i">
<li>One individual was 188 cm. He was above average by how many standard deviations?</li>
<li>Another individual was 174.66 cm. She was above average by how many standard deviations?</li>
<li>A third individual was 1.5 standard deviations below the average height. He was how many cm?</li>
<li>If an individual was within 2.25 standard deviations of average height, the shortest height for this individual would be how many cm? The highest height would be how many cm?</li>
</ol>
<p>Exercise 2:</p>
<ol type="a">
<li>Here are the heights of 4 individuals. 150 cm, 130 cm, 180 cm, 172 cm. Match the heights with the description. A description may be used twice.</li>
</ol>
<p>unusually short, about average, unusually tall</p>
<ol start="2" type="a">
<li>About what percentage of individuals in the data had heights between 170.2 and 173.2 ? Between 165.5 and 179.2?</li>
</ol>
<p>Exercise 3:</p>
<p>Each of the following lists has an average of 50. For which one is the spread of the numbers around the average biggest? Smallest?</p>
<ol type="i">
<li><pre><code>0, 20, 40, 50, 60, 80, 100</code></pre></li>
<li>0, 48, 49, 50, 51, 52, 100</li>
<li>0,1,2,50,98, 99, 100</li>
</ol>
<p>Exercise 4:</p>
<p>Each of the following lists has an average of 50. For each one, guess whether the standard deviation is around 1, 2, or 10. (This does not require any arithmetic.)</p>
<ol type="a">
<li>49, 51, 49, 51, 49, 51, 49, 51, 49, 51</li>
<li>48, 52, 48, 52, 48, 52, 48, 52, 48, 52</li>
<li>48, 51, 49, 52, 47, 52, 46, 51, 53, 51</li>
<li>54, 49, 46, 49, 51, 53, 50, 50, 49, 49</li>
<li>60, 36, 31, 50, 48, 50, 54, 56, 62, 53</li>
</ol>
<p>Exercise 5:</p>
<p>Below are three sketches of three stylized histograms (we call them “sketches” because they display a schematic shape of a hypothetical histogram. This is why these sketches do not look like real histograms.) Match the sketch with the description. Some descriptions will be left over. Give your reasoning in each case. The symbol <span class="math inline">\(\approx\)</span> is the mathematical notation for <em>approximately</em>.</p>
<ol type="i">
<li>ave <span class="math inline">\(\approx\)</span> 3.5, sd <span class="math inline">\(\approx\)</span> 1 (iv) ave <span class="math inline">\(\approx\)</span> 2.5, sd <span class="math inline">\(\approx\)</span> 1</li>
<li>ave <span class="math inline">\(\approx\)</span> 3.5, sd <span class="math inline">\(\approx\)</span> 0.5 (v) ave <span class="math inline">\(\approx\)</span> 2.5, sd <span class="math inline">\(\approx\)</span> 0.5</li>
<li>ave <span class="math inline">\(\approx\)</span> 3.4, sd <span class="math inline">\(\approx\)</span> 2 (vi) ave <span class="math inline">\(\approx\)</span> 4.5, sd <span class="math inline">\(\approx\)</span> 0.5</li>
</ol>
<div id="fig-histograms" class="quarto-layout-panel">
<figure class="figure">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 33.3%;justify-content: center;">
<div id="fig-hist_ex_1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="pictures/hist_ex_1.png" class="img-fluid figure-img" data-ref-parent="fig-histograms"></p>
<figcaption class="figure-caption">(a) Histogram 1</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 33.3%;justify-content: center;">
<div id="fig-hist_ex_2" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="pictures/hist_ex_2.png" class="img-fluid figure-img" data-ref-parent="fig-histograms"></p>
<figcaption class="figure-caption">(b) Histogram 2</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 33.3%;justify-content: center;">
<div id="fig-hist_ex_3" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="pictures/hist_ex_3.png" class="img-fluid figure-img" data-ref-parent="fig-histograms"></p>
<figcaption class="figure-caption">(c) Histogram 3</figcaption>
</figure>
</div>
</div>
</div>
<p></p><figcaption class="figure-caption">Figure&nbsp;3.5: Three stylized histograms</figcaption><p></p>
</figure>
</div>
<p>Exercise 6:</p>
<p>One investigator takes a sample of 100 men age 18 - 24 in a certain town. Another one takes a sample of 1000 such men.</p>
<ol type="a">
<li><p>Which investigator will get a bigger average for the heights of the men in his sample? Or should the average be about the same?</p></li>
<li><p>Which investigator will get a bigger standard deviation for the heights of the men in his sample? or should the standard deviation be about the same for both investigators?</p></li>
<li><p>Which investigator is likely to get the tallest of the sample men? Or are the chances about the same for both investigators?</p></li>
<li><p>Which investigator is likely to get the shortest of the sample men? Or are the chances about the same for both investigators?</p></li>
</ol>
</section>
<section id="computing-the-standard-deviation" class="level3" data-number="3.3.5">
<h3 data-number="3.3.5" class="anchored" data-anchor-id="computing-the-standard-deviation"><span class="header-section-number">3.3.5</span> Computing the standard deviation</h3>
<p>Usually we will compute the standard deviation using the computer and only in rare cases will we ever compute a standard deviation by hand. Still it is important that you understand how the computation works and what is actually been computed. Here is how.</p>
<p>Example 1: Find the standard deviation of the list 20, 10, 15, 15</p>
<p>Step 1: We first need to find the average, which is <span class="math display">\[\begin{equation}
\frac{20 + 10 + 15 + 15}{4} = 15
\end{equation}\]</span></p>
<p>Step 2: We next need to find the deviation from the average. In order to do so, we just subtract the average from each entry <span class="math display">\[\begin{eqnarray}
(20-15)&amp;=5\\
(10-15)&amp;=&amp;-5\\
(15-15)&amp;=&amp;0\\
(15-15)&amp;=&amp;0
\end{eqnarray}\]</span></p>
<p>Step 3: Now we have to square each one of these differences and take the square root, which is often called the root mean square</p>
<p><span class="math display">\[\begin{eqnarray}
sd&amp;=&amp;\sqrt{\frac{5^2 + (-5)^2 + 0^2 + 0^2}{4}} \\
&amp;=&amp; \sqrt{\frac{25 + 25 + 0 + 0}{4}} \\
&amp;=&amp; \sqrt{\frac{50}{4}}\\
&amp;=&amp; \sqrt{12.4}\\
&amp;\approx&amp; 3.5
\end{eqnarray}\]</span></p>
<p>The standard deviation has the same units as the data. For example, when we measure height in cm then at the squaring step the units change to <span class="math inline">\(cm^2\)</span> but the suqre root returns <span class="math inline">\(cm\)</span> again.</p>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Now you try
</div>
</div>
<div class="callout-body-container callout-body">
<ol type="1">
<li>Guess which of the following two lists has the larger standard deviation. Check your guess by computing the standard deviation for both lists.</li>
</ol>
<ol type="i">
<li>9,9,10,10,12</li>
<li>7,8,10,11,11,13</li>
</ol>
<ol start="2" type="1">
<li><p>Can the standard deviation ever be negative?</p></li>
<li><p>For a list of positive numbers can the standard deviation ever be larger than the average?</p></li>
</ol>
</div>
</div>
</section>
<section id="interquartile-range-and-the-boxplot" class="level3" data-number="3.3.6">
<h3 data-number="3.3.6" class="anchored" data-anchor-id="interquartile-range-and-the-boxplot"><span class="header-section-number">3.3.6</span> Interquartile range and the boxplot</h3>
<p>Note that for skewed distributions the standard deviation is also not a very good measure of the spread, because it measures the variation about the mean and the mean does not capture the center of the distribution very well in this case.</p>
<p>Moreover the standard deviation - like the mean - is sensitive to outliers and is therefore not a robust measure of the spread of a distribution.</p>
<p>A measure that is more appropriate in this case is the inter-quartile range or IQR. It is the distance between the 25th and the 75th percentile of the data and contains the central half of the data. The 25th percentile is the range of the data where 25 % of observations have a lower value and 75 have a higher one. The median, for example, could equivalently be termed the 50 % percentile.</p>
<p>R had a function to compute the inter-quartile range, which is called <code>IQR()</code>. For example in the case of our income data, which we showed are skewed, we would get, for example a mean and a standard deviation of</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb154"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3012.174</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb156"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb156-1"><a href="#cb156-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3160.662</code></pre>
</div>
</div>
<p>and a median and inter quartile range of</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb158"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb158-1"><a href="#cb158-1" aria-hidden="true" tabindex="-1"></a><span class="fu">median</span>(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1700</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb160"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb160-1"><a href="#cb160-1" aria-hidden="true" tabindex="-1"></a><span class="fu">IQR</span>(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3220</code></pre>
</div>
</div>
<p>Alternatively you could use the R function <code>summary()</code>, which computes in one go the minimum and maximum value of your data, as well as the median the mean and the 25 and 75 percentile of the data. You can compute the IQR from this.</p>
<p>Let us illustrate the use of <code>summary()</code> with the income data discussed in this section. To compute the describtives in one go for these data, you would tell R:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb162"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb162-1"><a href="#cb162-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
     20     820    1700    3012    4040   14000 </code></pre>
</div>
</div>
<p>The <code>summary()</code>function will give you the minimium, the first quartile, the median and the mean, the 4th quartile and the maximum. The interquartile range can be computed from these data as <span class="math inline">\(4040 - 820\)</span> which is equal to <span class="math inline">\(3220\)</span>. When you use <code>IQR()</code>you will get</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb164"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb164-1"><a href="#cb164-1" aria-hidden="true" tabindex="-1"></a><span class="fu">IQR</span>(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3220</code></pre>
</div>
</div>
<p>as indeed it should be.</p>
<p>Note that is you summarize our human height data we get:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb166"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb166-1"><a href="#cb166-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(dat<span class="sc">$</span>Height)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  153.1   169.4   172.7   172.7   176.0   190.9 </code></pre>
</div>
</div>
<p>Since the median and the mean give you the same value, you can see already from these data that the distribution of the data is symmetric, as we have already seen before.</p>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Now you try
</div>
</div>
<div class="callout-body-container callout-body">
<p>For the list of numbers:</p>
<p>2, -1, 1, -1, 1, -2, 1.5, -0.2, 1.37, -1.37, 3</p>
<ol type="1">
<li>Compute the mean, the standard deviation, the median and the inter quartile range.</li>
<li>Draw a histogram</li>
</ol>
</div>
</div>
<p>A standard graphical tool that summarizes the data in an anology to the <code>summary()</code>function is the boxplot. The boxplot summarizes the variation of data graphically through quartiles. It draws a box, where one side corresponds to the lower quartile, while the opposie side corresponds to the upper quartile. The median is displayed as a line crossing the box. The boxplot also contains lines, which are called the <em>whiskers</em> extending the box indication variability outside the two quartiles. These observations are at the extremes of the variation of the data. Data points that differ significantly from the other data, often calles <em>outliers</em> are shown as individual points.</p>
<p>Let us show some of the datasets we have discussed in this section to illustrate this very useful tool which gives you a compact and very informative summary of a huge data set. Let us start with Nile river data we had looked at in the beginning of the section. T R function for making a boxplot is called <code>boxplot()</code> and is used like this:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb168"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb168-1"><a href="#cb168-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(Nile)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="summarizing_and_communicating_lots_of_data_files/figure-html/unnamed-chunk-86-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Here the box shows you the maximum and the minimum flow (the whiskers), the box surrounding the first and the fourth quartile as well as the median as the black line within the box. If you look up the help function of <code>boxplot()</code> you can learn about various ways to control the look of the plot.</p>
<p>You can display the boxplot vertically or horizontally, whatever seems more convenient in the given context. Assume for instance we would like to show the Nile river data in one graph displaying both the boxplot and the histogram at the same time, then it would be more informative to have the boxplot as a horizontal graph.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb169"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb169-1"><a href="#cb169-1" aria-hidden="true" tabindex="-1"></a>mat <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">ncol =</span> <span class="dv">1</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>) <span class="co"># first and second plot</span></span>
<span id="cb169-2"><a href="#cb169-2" aria-hidden="true" tabindex="-1"></a><span class="fu">layout</span>(<span class="at">mat =</span> mat, <span class="at">heights =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>)) <span class="co"># First and second row relative heights</span></span>
<span id="cb169-3"><a href="#cb169-3" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(Nile, <span class="at">horizontal =</span> <span class="cn">TRUE</span>)</span>
<span id="cb169-4"><a href="#cb169-4" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(Nile)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="summarizing_and_communicating_lots_of_data_files/figure-html/unnamed-chunk-87-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>But you could, of course, also choose a different layout. Lets take the primary energy consumption data we used before</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb170"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb170-1"><a href="#cb170-1" aria-hidden="true" tabindex="-1"></a>mat <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">1</span>), <span class="at">nrow =</span> <span class="dv">1</span>, <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>) <span class="co"># first and second plot</span></span>
<span id="cb170-2"><a href="#cb170-2" aria-hidden="true" tabindex="-1"></a><span class="fu">layout</span>(<span class="at">mat =</span> mat, <span class="at">widths =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>)) <span class="co"># First and second row relative heights</span></span>
<span id="cb170-3"><a href="#cb170-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(hist_info, <span class="at">freq =</span> <span class="cn">FALSE</span>, <span class="at">xlab =</span> <span class="st">""</span>, <span class="at">ylab =</span> <span class="st">"Percent"</span>, <span class="at">main =</span> <span class="st">" "</span>)</span>
<span id="cb170-4"><a href="#cb170-4" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(hist_info<span class="sc">$</span>density)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="summarizing_and_communicating_lots_of_data_files/figure-html/unnamed-chunk-88-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>This graph show you in one picture the extreme asymmetry of primary energy consumption across the globe. Very few countries are heavy consumers of primary energy whereas the a huge share of countries consume very little in comparison. In the context of the debate on climate change, this observation might be an interesting starting point for discussing the sharing of the burdens of getting out of fossile fuels between the countries in the world.</p>
<p>Let us finally look at the Nile river data once more combining the display of the raw data, the histogram as well as the boxplot. This shows you at the same time the raw data, and two ways of summarizing them. When the datapoints are huge, the display of the raw data will not show you very much, because the points will be so packed that you can not distinguish different datapoints easily. Withe the Nile river flow data, where we have 100 observations the situation is different. So this is how the picture of all three graphs combined looks like.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb171"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb171-1"><a href="#cb171-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Data</span></span>
<span id="cb171-2"><a href="#cb171-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb171-3"><a href="#cb171-3" aria-hidden="true" tabindex="-1"></a><span class="fu">layout</span>(<span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">3</span>),</span>
<span id="cb171-4"><a href="#cb171-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">ncol =</span> <span class="dv">2</span>,</span>
<span id="cb171-5"><a href="#cb171-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">byrow =</span> <span class="cn">TRUE</span>),</span>
<span id="cb171-6"><a href="#cb171-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">widths =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">1</span>),</span>
<span id="cb171-7"><a href="#cb171-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">heights  =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>), <span class="at">respect =</span> <span class="cn">TRUE</span>)</span>
<span id="cb171-8"><a href="#cb171-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb171-9"><a href="#cb171-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Top and right margin of the main plot</span></span>
<span id="cb171-10"><a href="#cb171-10" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="fl">5.1</span>, <span class="fl">4.1</span>, <span class="dv">0</span>, <span class="dv">0</span>))</span>
<span id="cb171-11"><a href="#cb171-11" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">as.numeric</span>(Nile), <span class="at">xlab =</span> <span class="st">""</span>, <span class="at">ylab =</span> <span class="st">"Flow"</span>)</span>
<span id="cb171-12"><a href="#cb171-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb171-13"><a href="#cb171-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Left margin of the histogram</span></span>
<span id="cb171-14"><a href="#cb171-14" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">4.1</span>, <span class="dv">0</span>, <span class="dv">0</span>))</span>
<span id="cb171-15"><a href="#cb171-15" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(Nile, <span class="at">main =</span> <span class="st">""</span>, <span class="at">bty =</span> <span class="st">"n"</span>,</span>
<span id="cb171-16"><a href="#cb171-16" aria-hidden="true" tabindex="-1"></a>     <span class="at">axes =</span> <span class="cn">FALSE</span>, <span class="at">ylab =</span> <span class="st">""</span>)</span>
<span id="cb171-17"><a href="#cb171-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb171-18"><a href="#cb171-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Bottom margin of the boxplot</span></span>
<span id="cb171-19"><a href="#cb171-19" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="fl">5.1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>))</span>
<span id="cb171-20"><a href="#cb171-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb171-21"><a href="#cb171-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Boxplot without plot region box</span></span>
<span id="cb171-22"><a href="#cb171-22" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">bty =</span> <span class="st">"n"</span>)</span>
<span id="cb171-23"><a href="#cb171-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb171-24"><a href="#cb171-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Boxplot without axes</span></span>
<span id="cb171-25"><a href="#cb171-25" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(Nile, <span class="at">axes =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="summarizing_and_communicating_lots_of_data_files/figure-html/unnamed-chunk-89-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="describing-differences-between-groups-of-numbers" class="level2" data-number="3.4">
<h2 data-number="3.4" class="anchored" data-anchor-id="describing-differences-between-groups-of-numbers"><span class="header-section-number">3.4</span> Describing differences between groups of numbers</h2>
<p>Groups of numbers are often compared by using summary statistics. Summary statistics can answer the question: How do the groups differ <em>on average</em>, how do they differ with respect to how spread out the observations are.</p>
<p>By this stage of the chapter on summarizing and communicating lost of data it should be clear that when we conduct such comparisons, we have to be mindful of the fact that summary measures hide information that depending on the way the data are distributed some summary measures are more appropriate than others.</p>
<p>Let us use data on human height to illustrate these points. Our data includes a set of anthropometric data from a textbook by the anthropologist Richard McElrath (<span class="citation" data-cites="McElr2020">McElrath (<a href="references.html#ref-McElr2020" role="doc-biblioref">2020</a>)</span>). If we summarize the height data of men and women in this dataset using the R summary function we get</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb172"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb172-1"><a href="#cb172-1" aria-hidden="true" tabindex="-1"></a>mh <span class="ot">&lt;-</span> height_weight<span class="sc">$</span>height[height_weight<span class="sc">$</span>sex <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> height_weight<span class="sc">$</span>age <span class="sc">&gt;=</span> <span class="dv">18</span>] <span class="sc">|&gt;</span> <span class="fu">na.omit</span>()</span>
<span id="cb172-2"><a href="#cb172-2" aria-hidden="true" tabindex="-1"></a>fh <span class="ot">&lt;-</span> height_weight<span class="sc">$</span>height[height_weight<span class="sc">$</span>sex <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> height_weight<span class="sc">$</span>age <span class="sc">&gt;=</span> <span class="dv">18</span>] <span class="sc">|&gt;</span> <span class="fu">na.omit</span>()</span>
<span id="cb172-3"><a href="#cb172-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb172-4"><a href="#cb172-4" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(<span class="fu">list</span>(<span class="at">Male =</span> mh, <span class="at">Female =</span> fh), summary)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$Male
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  139.7   157.5   160.7   160.4   163.8   179.1 

$Female
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  136.5   146.1   149.9   149.5   153.0   162.6 </code></pre>
</div>
</div>
<p>The summary statistics shows as a few facts about these data. First of all we see that both for the male height data as well as for the female height data the mean and the median are about the same and thus the distributions are roughly symmetric. The mean thus actually captures the “center” of the distribution in a meaningful way. On average men are taller than women. The variation in terms of the inter quartile range is about the same between 6 and 7 cm.</p>
<p>Note that this does not mean that all men are taller than women. Let’s look at the full data in terms of the histogram.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb174"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb174-1"><a href="#cb174-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(mh, <span class="at">col=</span><span class="fu">rgb</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,.<span class="dv">5</span>), <span class="at">border=</span><span class="cn">NA</span>, <span class="at">xlab =</span> <span class="st">"Height in cm"</span>, <span class="at">main =</span> <span class="st">"Comparative histogram male and female height"</span>, <span class="at">breaks =</span> <span class="dv">14</span>)</span>
<span id="cb174-2"><a href="#cb174-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(fh, <span class="at">col=</span><span class="fu">rgb</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,.<span class="dv">5</span>), <span class="at">border=</span><span class="cn">NA</span>, <span class="at">breaks =</span> <span class="dv">9</span>, <span class="at">add=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="summarizing_and_communicating_lots_of_data_files/figure-html/unnamed-chunk-91-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>We have colored the female height distribution in blue and the male height distribution in red and overlayed the histograms. Now you can see that men tend to be taller than women as expressed in the differences in the averages there is also a substantial amount of overlap in the distributions. For each male in this overlap region you will find a female with a matching height, and some who are taller than a given male individual. About 10 % of women in this dataset have a male twin in height.</p>
<p>If you describe data and compare them by summary measures there is no substitute for looking at the data properly. It is usually a good idea to look at the distribution as well as on the summary measures.</p>
</section>
<section id="describing-relationships-between-data" class="level2" data-number="3.5">
<h2 data-number="3.5" class="anchored" data-anchor-id="describing-relationships-between-data"><span class="header-section-number">3.5</span> Describing Relationships between data</h2>
<p>Are taller people also heavier? This is another way in which we can look at large sets of data and describe their pattern. We try to describe the relationship between data. A standard tool to do so is the so called scatterplot.</p>
<p>Let us show how a scatterplot works by using the data on height and weight of humans older than 18 years. If you give two numeric vectors of equal length to the function <code>plot()</code> in R R will produce a scatterplot.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb175"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb175-1"><a href="#cb175-1" aria-hidden="true" tabindex="-1"></a>H <span class="ot">&lt;-</span> socr_height_weight<span class="sc">$</span>Height<span class="sc">*</span><span class="fl">2.54</span></span>
<span id="cb175-2"><a href="#cb175-2" aria-hidden="true" tabindex="-1"></a>W <span class="ot">&lt;-</span> socr_height_weight<span class="sc">$</span>Weight<span class="sc">*</span><span class="fl">0.4535924</span></span>
<span id="cb175-3"><a href="#cb175-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb175-4"><a href="#cb175-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(H,W, <span class="at">xlab =</span> <span class="st">"Height in cm"</span>, <span class="at">ylab =</span> <span class="st">"Weight in kg"</span>, <span class="at">main =</span> <span class="st">"Relation between height and weight of adult humans"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="summarizing_and_communicating_lots_of_data_files/figure-html/unnamed-chunk-92-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>What you see here is a dense cloud of 25.000 pairs of height and weight measurements. For any given height you see a whole range of observations with different weights. And for any given weight you see many observations with differing heights. But the cloud as a whole shows an increasing relation. This makes also intuitive sense. People who are taller tend to be also heavier.</p>
<p>It is sometimes convenient to summarize such increasing (or decreasing) relationships between two variables or the pairs of numbers shown in a scatterplot with a single number. The general choice for doing this is the <em>Pearson correlation coefficient</em> or simply the correlation.</p>
<p>The Pearson correlation coefficient is a number that can be between -1 and 1. It epresses how close to a straight line the data-points in the scatterplot fall. If the correlation coerfficient is 1 all points lie on an upward sloping straight line. If the coeficcient is - 1 all the points fall on a downward sloping straight line. A correlation coefficient of 0 can come from points scattered at random or any other pattern in which there is no systematic upward or downward trend.</p>
<p>R provides a function for the Pearson correlation coefficient, which is called <code>cor()</code>. For our height-weight pairs data used for the scatterplot this coefficient computes as</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb176"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb176-1"><a href="#cb176-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(H,W)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.5028585</code></pre>
</div>
</div>
<p>suggesting an association of increasing weight with increasing height.</p>
<p>A correlation coefficient is simply a one number summary of association or co-variation. It can not be used to conclude that there is definitely an underlying relationship between height and weight - in this example - nor can it say anything about why such a relationship may exist.</p>
</section>
<section id="describing-trends" class="level2 page-columns page-full" data-number="3.6">
<h2 data-number="3.6" class="anchored" data-anchor-id="describing-trends"><span class="header-section-number">3.6</span> Describing Trends</h2>
<p>Let us come back to the data on human height. One reason why data on height have always been interesting to researchers is that average height is strongly correlated with living standards in a population. This is because poor nutrition and poor medical support limit human growth. Because better living conditions tend to make humans taller they are an indirect measure of living stanrdards. Height is - of course - not a direct measure of well beeing. The variation of height in a given population is largely determined by genetic fatcors.</p>
<p>Looking at the trend of average height over time helps us to indirectly track progress especially with respect to conditions of nutrition and disease prevention. The time trends in average human height are therefore data that can tell interesting stories or open our interest for further exploration.</p>
<div class="page-columns page-full"><p>Let us use a dataset on the average height of men and women accross countries around the world from 1896 to 1996 which we retrieve from the site our world in data which we have now encountered several times by now<a href="#fn12" class="footnote-ref" id="fnref12" role="doc-noteref"><sup>12</sup></a>.</p><div class="no-row-height column-margin column-container"><li id="fn12"><p><sup>12</sup>&nbsp;https://ourworldindata.org/human-height</p></li></div></div>
<p>Let us study, for instance the data for the world as a whole</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb178"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb178-1"><a href="#cb178-1" aria-hidden="true" tabindex="-1"></a>mh <span class="ot">&lt;-</span> height_men</span>
<span id="cb178-2"><a href="#cb178-2" aria-hidden="true" tabindex="-1"></a>fh <span class="ot">&lt;-</span> height_women</span>
<span id="cb178-3"><a href="#cb178-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb178-4"><a href="#cb178-4" aria-hidden="true" tabindex="-1"></a>mh_w <span class="ot">&lt;-</span> height_men[height_men<span class="sc">$</span>Entity <span class="sc">==</span> <span class="st">"World"</span>, ]</span>
<span id="cb178-5"><a href="#cb178-5" aria-hidden="true" tabindex="-1"></a>fh_w <span class="ot">&lt;-</span> height_women[height_women<span class="sc">$</span>Entity <span class="sc">==</span> <span class="st">"World"</span>, ]</span>
<span id="cb178-6"><a href="#cb178-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb178-7"><a href="#cb178-7" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> mh_w<span class="sc">$</span>Year</span>
<span id="cb178-8"><a href="#cb178-8" aria-hidden="true" tabindex="-1"></a>y1 <span class="ot">&lt;-</span> mh_w<span class="sc">$</span>Height</span>
<span id="cb178-9"><a href="#cb178-9" aria-hidden="true" tabindex="-1"></a>y2 <span class="ot">&lt;-</span> fh_w<span class="sc">$</span>Height</span>
<span id="cb178-10"><a href="#cb178-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb178-11"><a href="#cb178-11" aria-hidden="true" tabindex="-1"></a><span class="co">#plot the first data series using plot()</span></span>
<span id="cb178-12"><a href="#cb178-12" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x, y1, <span class="at">type=</span><span class="st">"l"</span>, <span class="at">col=</span><span class="st">"blue"</span>, <span class="at">ylab=</span><span class="st">"y"</span>, <span class="at">lty=</span><span class="dv">1</span>, <span class="at">ylim=</span><span class="fu">range</span>( <span class="fu">c</span>(<span class="dv">150</span>, <span class="dv">180</span>) ) )</span>
<span id="cb178-13"><a href="#cb178-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb178-14"><a href="#cb178-14" aria-hidden="true" tabindex="-1"></a><span class="co">#add second data series to the same chart using points() and lines()</span></span>
<span id="cb178-15"><a href="#cb178-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb178-16"><a href="#cb178-16" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x, y2, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">col=</span><span class="st">"red"</span>,<span class="at">lty=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="summarizing_and_communicating_lots_of_data_files/figure-html/unnamed-chunk-94-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="summary" class="level2" data-number="3.7">
<h2 data-number="3.7" class="anchored" data-anchor-id="summary"><span class="header-section-number">3.7</span> Summary</h2>
</section>
<section id="computer-exercises" class="level2" data-number="3.8">
<h2 data-number="3.8" class="anchored" data-anchor-id="computer-exercises"><span class="header-section-number">3.8</span> Computer exercises</h2>
<p>Open the notebook <code>exercises_summarizing_and_communicating_lots_of_data.ipynb</code> and work on the exercises. Write your solutions into the notebook. You will need the computer to do this work.</p>
<!-- ## Contents  -->
<!-- Statistics usually involves lots of data and we need ways to communicate and summarize these data. This -->
<!-- chapter introduces the most important concepts. -->
<!-- 1. The empirical distribution of data points -->
<!-- 2. Measures of location and spread. -->
<!-- 3. Skewed data distributions are common and some summary statistics are very sensitive to outlying values.  -->
<!-- 4. Summaries always hide some detail.  -->
<!-- 5. How to summarize sets of numbers graphically (histograms and box plots) -->
<!-- 6. Useful transformations to reveal patterns -->
<!-- 7. Looking at pairs of numbers, scatter plots, time series as line graphs.  -->
<!-- 8. The primary aim in data exploration is to get an idea of the overall variation. -->
<!-- ## Next steps in R: -->
<!-- - vectors and indices -->
<!-- - extracting subsets from vectors -->
<!-- - creating vectors using c() -->
<!-- - subsetting vectors wit logicals -->
<!-- - data frames -->
<!-- - factor class -->
<!-- - extracting data from data frames -->
<!-- - tapply -->
<!-- ## Outcome  -->
<!-- Understand these concepts and work through may examples showing how to apply these summary measures to data on the -->
<!-- computer. -->


<div id="refs" class="references csl-bib-body hanging-indent" role="list" style="display: none">
<div id="ref-HelMau2015" class="csl-entry" role="listitem">
Hellebrand, Tomas, and Paolo Mauro. 2015. <span>“The Future of Worldwide Income Distribution.”</span> <em>Brooking Institution Working Paper Series</em> 7 (15). <a href="file:///home/martinsummer/R/Statistics_JWL/data/income/Hellebrand_Mauro_wp15-7.pdf">file:///home/martinsummer/R/Statistics_JWL/data/income/Hellebrand_Mauro_wp15-7.pdf</a>.
</div>
<div id="ref-McElr2020" class="csl-entry" role="listitem">
McElrath, Richard. 2020. <em>Statistical Resthinking</em>. CRC Press. <a href="https://github.com/rmcelreath/rethinking">https://github.com/rmcelreath/rethinking</a>.
</div>
</div>
</section>


</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./categorical_data_and_proportions.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Categorical Data and Proportions</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./from_limited_data_to_populations.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">From limited data to populations</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>