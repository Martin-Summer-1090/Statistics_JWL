# Modelling relationships

<!-- ## Contents  -->
<!-- Regression models provide a mathematical representation between a set of explanatory variables and a response.  -->


<!-- 1. The coefficients in a regression represent how much we expect the response to change when the explanatory variable is observed to change.  -->
<!-- 2. Regression to the mean -->
<!-- 3. Regression models can incorporate different types of response variable -->
<!-- 4. Explanatory variables and non-linear relationships -->
<!-- 5. Be cautious in interpreting models and don’t take them literally. -->


<!-- ## Outcome -->

<!-- The students should understand the concept of regression and how it works and should be correctly interpreted. They should develop a good understanding that a method like regression does not provide an automatism for making predictions and will always need cautious interpretation. The students should learn some tools and example what cautious interpretation means and what is helpful in this respect.  -->

## Statistical models

In our course so far we have encountered various methods which allow us to visualize and
summarize data consisting of a single set of numbers. These 
simple techniques have already taken us 
quite far and allowed us to look at various interesting real world questions.

In general modern data are much more complex. In such more complex situations, involving 
whole lists of related variables, we need more powerful tools. In this chapter we are going to
take a first step in introducing the idea of a **statistical model**.

A statistical model is a mathematical representation of the relationship between variables
which we can use for the prediction of the value of one variable using the
value of another variable or the values of a list of other
variables. It also allows us a more precise description of the relationship between
variables.

Statistical models inevitably involve some mathematical ideas, which you need to understand 
to confidently work with these models and use them. In this chapter we will introduce you
to these ideas step by step, going into actual statistical models and its most
important form, regression analysis in the next chapter.

## Plotting points and lines

In this section we review some ideas about plotting points and lines which we will need
for understanding statistical models. For some of you this might be a refresher of
concepts you have already encountered in school, for others this material might be new.

### Reading points off a graph

@fig-coordinates shows two coordinate systems, coordinatesystem 1 and coordinatesystem 2. The
graphs of the coordinate systems have a horizontal axis, the $x$-axis and a vertical axis,
the $y$-axis. Each point in the plane can be described by its coordinates, given by an $x$ value
and a $y$ value.

For example, the point shown in coordinatesystem 1 is the point $(x,y) = (2,3)$. This is
the point you get in the plane, if you move from the origin $(0,0)$ 2 units to the right on the $x$-axis and then 3 units up on the $y$-axis.

In the second coordinate system, cordinatesystem b, you see the plot of a point 
$(x,y) = (-1.5, -0.8)$ with the coordinates $(-1.5,-0.8)$. The idea to represent
points in a plane by pairs of numbers (their coordinates) is very powerful because
it combines two apparently different field, algebra - the manipulation of numbers by adding, subtracting etc. - and geometry, lines, points and other geometric objects. This idea
goes back to the french philosopher and mathematician Rene Descartes (1556 - 1630).^[Rene Descartes was born in 1556 and died in 1630. He was a french philosopher and mathematician and scientist. His connection of the two previously separated fields of geometry and algebra into the field of analytic geometry is one of his lasting contribution to mathematics. Here you see a portait painted by the Dutch painter Frans Hals. 
![Descartes](pictures/330px-Frans_Hals_-_Portret_van_René_Descartes.jpg)] This
is why the $x$ and $y$ coordinates are often referred as "cartesian coordinates".

::: {#fig-coordinates layout-ncol=2}

![Coordinatesystem 1](pictures/coordinates_a.png){#fig-coorda}

![Coordinatesystem 2](pictures/coordinates_b.png){#fig-coordb}

Coordinate Systems
:::

:::{.callout-note icon=false}

### Now you try


![Five points in a coordinate system](pictures/coordinates_c.png){#fig-coordc}

@fig-coordc shows 5 points plotted in a coordinate system.

1. Write down the $x$ and $y$ coordinate for each point.
2. As you move from point A to point B in @fig-coordc, explain by how mauch your $x$-coordinate and your $y$-coordinate goes up.
3. One point in @fig-coordc has a $y$-coordinate 1 bigger than the $y$-coordinate of 
point E. Which point is this?
:::

### Plotting Points

Assume we want to plot a point $(x,y) = (2,3)$.

::: {#fig-plot-points layout-ncol=3}

![Plotting point (2,3): The coordinate system](pictures/plot_point_a.png){#fig-plota}

![Plotting point (2,3): The x-coordinate](pictures/plot_point_b.png){#fig-plotb}

![Plotting point (2,3): The y-coordinate combined with the x-coordinate](pictures/plot_point_c.png){#fig-plotc}

Plotting a point.
:::

Here is a step by step procedure outlined in @fig-plot-points.
We start with a coordinate system as depicted in @fig-plota.
The $x$ coordinate is at 2. We could imagine a dotted line starting at $x=2$ and extending 
vertically through the coordinate system as shown in @fig-plotb.
Finally the $y$ coordinate has value 3. We could imagine a dashed line starting at the
$y = 3$ coordinate parallel to the $x$ axes as shown in @fig-plotc
The point $(2,3)$ is where both of the dashed lines intersect.

With the help of the computer, you can of course plot points automatically. Let me show
you how.

Say we want to plot the points $(1,1)$, $(2,2)$, $(3,3)$ and $(4,4)$ with R. The way 
we plot these data would be that we represent the coordinates in R as a dataframe (see 3.2.4)
like this.
```{r}
#| code-fold: false

points <- data.frame(x = c(1,2,3,4), y= c(1,2,3,4))
```

The first column in the dataframe which we named `points` contains all the values of
the x-coordinates, the second column contains all the values of the y-coordinates.

Now if we give the object `points`as an argument to the plot function of R we get a plot of the
points in the appropriate coordinate system. Let's try this:

```{r}
#| code-fold: false

plot(points, pch = 19)

```

As an aside the argument `pch = 19` given to the plot function tells R to show
the dots filled instead as unfilled circles. This is a bit opaque and difficult to
remember. The default values also vary depending on which object is plotted. 
You do not have to remember such details. They are usually recovered as needed
from the help function.^[Here is the full list of possible values for the `pch` argument and
what they do. The default value in `plot` is `pch = 1`. ![Possible values for pch](pictures/r-plot-pch-symbols-points-in-r.png)]


### Slope and Intercept

The following figure shows a line.

![Line](pictures/slope_a.png){#fig-slope}

Take any point on this line, say point A. Now move up the line to any other point, say B.
When you make such a move, your $x$-coordinate has increased by some amount. We call this
increase $\Delta x$.^{\Delta is a greek letter and in mathematical notation it is
often used to symbolize change} In our picture $\Delta x = 2$ because we moved two units to the
right. At the same time you $y$-coordinate has increased by some other amount which we
call $\Delta y$. In our picture $\Delta y = 1$. The ratio $\Delta y/ \Delta x$ is called
the **slope** of the line. Whatever points you take on this line the slope will always be
1/2.

::: {.callout-important}
slope = $\frac{\Delta y}{\Delta x}$
:::

The slope is the rate at which $y$ increases with $x$ along the line. 

:::{.callout-note icon=false}

### Now you try

What is the slope of these two lines?

::: {#fig-plot-slopes layout-ncol=2}

![Slope 1](pictures/slope_b.png){#fig-slopeb}

![Slope 2](pictures/slope_c.png){#fig-slopec}

Different slopes
:::

:::

The **intercept** of a line is the value of the $y$-coordinate at $x = 0$. You
could also say that the intercept is the point where the line crosses the $y$-axis.^[We have to
be careful with this rule of thumb because this intersection property is true only
if  the $x$-axis and the $y$-axis cross at the origin $(0,0)$].

For example in @fig-slope the intercept is 1, in @fig-slopeb is 2 and in @fig-slopec
the intercept is 3.

### How to plot a line

Assume you have to plot a line which passes through the point $(2,1)$ and has a slope of
$\frac{1}{2}$. How would we plot this line?

The first step is that we draw the point $(2,1)$ into the coordinate system, like this:

![Coordinate system with point (2,1)](pictures/line_a.png){#fig-linesa}

Next you move any convenient distance $\Delta x$ to the right like this, say we move
3 units. Make a point at this location like this

![Coordinate system with point (2,1) and construction point (5,1)](pictures/line_b.png){#fig-linesb}

Since the line slopes up - the slope is positive an 1/2 - the line passes above this point. 
The question is, how far?. To find the answer to the question ho much will the line
rise in a $\Delta x$ of 3? The answer can be found from the formula of the slope. The
line rises at the rate of half a vertical unit per horizontal unit. Thus we have
\begin{equation}
\Delta y = \Delta x \times \text{slope}
\end{equation}
In our case this means $3 \times \frac{1}{2} = 1.5$ Thus from the contruction point $(5,1)$
we have to go up 1.5 units and mark a new point there. Now if you join these two points using
a ruler you get the line like this

![The third point](pictures/line_c.png){#fig-linesc}

:::{.callout-note icon=false}

### Now you try

1. Draw lines through the point (2,1) with the following slopes: 1, -1, 0
2. Start at point (2,1). If you move 2 to the right and 1 up will you be on the line,
   above the line or below  the line?
3. Draw the line with intercept 2 and slope -1.
4. Draw the line with intercept 2 and slope 1.

:::

### The algebraic equation for a line

Here is a rule for computing the coordinate $y$ of a point from its $x$ coordinate
\begin{equation}
y = \frac{1}{2}x + 1
\end{equation}

Let us make a table from this equation

| x       | y    | 
|:-------:|:----:|
| 1       | 1.5  |
| 2       | 2.0  |
| 3       | 2.5  |
| 4       | 3.0  |

If you plot these points, they all fall on a line. Any point whose $y$-coordinate
is related to its $x$-coordinate by the same equation $y = \frac{1}{2}x + 1$ 
will be on this line. This line is called the **graph** of the equation. The slope is
1/2, the coefficient of $x$ in the equation. The intercept is 1, the constant term
in the equation. We can draw a picture illustrating the situation

![The line through (2,2) with slope 1/2](pictures/line_d.png){#fig-linesd}

Using a general formulation we can say

::: {.callout-important}
The graph of equation $y = kx + d$ is a straight line with slope $k$ and intercept $d$
:::


### Plotting lines, using R

The examples we discussed so far helped you understand how to draw equations
like
\begin{equation}
y = k x + d
\end{equation}

by hand and to switch between the algebraic and geometric
description of such equations. Of course you can use R to do such plots.

We briefly discuss how. Let us generate some example data for the case of
the first equation in exercise 1:

\begin{equation}
y = 2x + 1
\end{equation}

We can draw such lines in R using the R function `curve()`. This function 
requires as arguments the equation of the line and the range from where to
where the $x$ variable should go. Let us start at $x=0$ and let x go to $x=5$:

```{r}
#| code-fold: false
curve(1 + 2*x, from = 0, to = 5)
```

Here is another example, which is slightly more interesting because of its
context. Consider the linear equation

\begin{equation}
y = 1007 - 0.393*x
\end{equation}

According to @GelmanHillVehtari2021 this line approximates the trajectory
of the world record time in seconds for the mile run based on data starting
from the year 1900. 

To draw a curve like this by R, and assuming we plot the curve for
the arguments $x = 1$, $x = 2$, $x = 3$ , $x = 4$ and $x = 5$, you would 
best choose the R function `curve()` and a code like this:

```{r}
#| code-fold: false

curve(1007 - 0.393*x, from = 0, to = 5)
```


::: {.callout-note}

## Now you try

Test your understanding of interpreting this line in the given context.

1. What is the intercept of the line?
2. What is the slope?
3. What is the interpretation of the intercept in the given context?
4. What is the interpretation of the slope in this context?
5. What is the mile run record in the beginning of our data in 1900?
6. What is the mile run record in 1990 assuming the line describes the
   relation accurately?
7. Is it reasonable to use the line to predict the mile run record in 2000? What do you think? 
8. Is it reasonable to assume that this trend will go on forever?

:::

Finally, let us assume we want to present a graph of the line, conveying the
context and which is easily readable. Then we need to use a different location and scale
of the graph and add a title as well as informative descriptions of the $x$ and the $y$
axis. This would be done in R as shown in the following code. 

```{r}
#| code-fold: false

curve(1007 - 0.393*x, 
      from = 1900, to = 2000, 
      xlab = "Year", 
      ylab = "Time (seconds)",
      main = "Approximate trend of world record times\n for the mile run")
```

Location and scale are controlled by starting the curve not at $x=0$ but at $x=1900$. R then
automatically adapts the scale by choosing appropriate units for $x$ and displaying not
each single year.

## Exercises:

### Exercise 1:

1. Plot the graphs of the following equations
\begin{eqnarray}
y &=& 2 x + 1 \\
y &=& \frac{1}{2}x + 2
\end{eqnarray}
In each case, determine the slope and the intercept and give the height of the line
at $x = 2$.

2. Plot four different points whose $y$-coordinate are double their $x$-coordinates. Do these
points lie on a line? What is the equation of this line?

3. Plot the points $(1,1)$, $(2,2)$, $(3,3)$ and $(4,4)$ on the same graph. These points
all lie on a line. What is the equation of this line?

4. True of false:
   (a) If $y$ is bigger than $x$, then the point $(x,y)$ is above the line of exercise 3.
   (b) If $y = x$ then the point $(x,y)$ is on the line of exercise 3.
   (c) If $y$ is smaller than $x$, then the point $(x,y)$ is below the line of 
       exercise 3.
       
### Exercise 2:

1. Three out of the following four points lie on a line. Which one does not? It is
   above or below the line?
   $(0,0), (0.5,0.5), (1,2), (2.5, 2.5)$
   You can try to answer this with pencil and paper or using R. Try both ways.

2. The table below shows four points. In each case the y-coordinate is computed from the x-coordinate by the rule $y = 2x + 1$. Fill in the blanks and then plot the four points. What can you say about them?

| x       | y    | 
|:-------:|:----:|
| 1       | 3    |
| 2       | 5    |
| 3       |      |
| 4       |      |

3. Look at the following shaded regions. Which of the following two points is in the region
   (1,2) or (2,1)? Answer this question for all three figures.

::: {#fig-plot-regions layout-ncol=3}

![Figure 1](pictures/shaded_a.png){#fig-shadea}

![Figure 2](pictures/shaded_b.png){#fig-shadeb}

![Figure 3](pictures/shaded_c.png){#fig-shadec}

Where is the point.

:::

### Exercise 3:

Look at the following line

![Figure 3](pictures/line_e.png){#fig-line_e}

1. What is the equation of this line? 
2. What is the height of the this line at $x = 1$?
3. Plot the line whose equation is $y = - \frac{1}{2}x + 4$

## Computer exercises

Open the Jupyter notebook "name_book" and work on the exercises there. When
you have done the exercises save your notebook and submit it.


