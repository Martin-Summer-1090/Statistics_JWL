#Categorical Data and Proportions

The death of a child is an enormous tragedy to its family and friends. The numbers
across the globe add up to millions. From 56 million people who died for example in the year
2017, 5.4 millions were children under the age of 5, as reported by Max Roser [@Ros]
in an interesting article on the website "Our world in Data" which we referred to
in our introduction to this course. This is a number of enormous scale that never makes the
headlines.

Max Roser [@Ros] on the website "our world in data", we have encountered in the introduction,
puts the scale very vividly into perspective. He writes:

"...*The suffering and dying of children remains immense, yet these daily tragedies continue without receiving the attention this injustice deserves. A comparison of the tragedy of child deaths with those tragedies that do receive public attention puts it in perspective. A large jumbo jet can carry up to 620 passengers. The number of child deaths is that of 24 jumbo jet crashes, with only children on board, every single day. Single events – such as plane crashes – always make the headlines. Daily tragedies – even the worst ones like the deaths of thousands of children – never make the headlines.*

Yet infant and child mortality in pre-industrial societies where uniformly and cruelly high. They
were a universal and frequent experience for families all over the world. 
In a scientific publication Anthony Volk 
and Jeremy Atkinson made an attempt  to report mortality 
rates of infants and children in the past, collecting data from a wide 
range of geographic locations and cultures reaching far
into the past [@VolAtk2013]. The mortality rate is defined as the number
of deaths per 1000 life births. 

The authors find that in the entire sample about 27 % of children 
died in their first year of life and 46 % died before they reached adulthood. These
rates are surprisingly similar across regions and cultures: Every forth newborn child died in the
first year of life, every second child during its childhood. These are truely 
grim numbers.

The numbers started to improve, very gradually only with the onset of industrialization. 
Gapminder, the
site we have already encountered in the introduction has 
collected and commented the available data back to 1800.^[See https://www.gapminder.org/data/documentation/gd002/]

Let us have a look at them. For instance, if we go back to 1850, we have data only 
from Europe.

```{r}
#| label: infant-mortality-1860
#| tbl-cap: Infant mortality in some European countries in 1860
#| warning: false
#| echo: false

# read data from data folder. The data are a csv version of the excel file from gapminder
# sheet data

infant_mortality <- read.csv("data/infant_mortality/infant_mortality_data_gm.csv")

# when we read the data all years are read sa characters with X as prefix, like X1850. We want
# to remove the X

names(infant_mortality) <- as.numeric(sub("X", "", names(infant_mortality), fixed = T))

# replace Infant.Mortality.Rate by country

names(infant_mortality)[1] <- "Country"

# transform to a long format and add to the counts a column with the mortality rate. The rate
# is defined as the number of death during the first year of life per 1000 life births.

library(tidyverse)

data <- as_tibble(infant_mortality)


mort_dat <- pivot_longer(data, !Country, names_to = "Year", values_to = "Count",  
                         values_transform = list(Count = as.numeric))

mort_dat$"Mortality Rate" <- ifelse(is.na(mort_dat$Count), NA, mort_dat$Count/1000)

# table for 1860

rate_1860 <- with(mort_dat, mort_dat[Year == 1860, c("Country", "Count", "Mortality Rate")]) %>% na.omit()

library(knitr)
kable(rate_1860[order(-rate_1860$"Mortality Rate"), ], digits = 3)
write.csv(rate_1860, file = "tables/table_2_1_infant_mortality_1860.csv", row.names = FALSE)
```

The table shows the counts of infant death during the first year in the year 1860 per 
1000 life births. Before we deal with the information conveyed by these data, let us take the
opportunity to discuss some terminology and technical terms that will be a focus of this
chapter. 

The data are shown here in a table. We have ordered the countries by the infant mortality rate, 
displaying the country with the highest rate first. 
The columns of the table are called *variables*. So 
the variables shown in this table are Country, Count and Mortality Rate. In the specific
example shown here we have data that record whether an event has happened or not, in our case the
death of an infant in his first year of life in a specific country during a specific year. 
Variables that can take only two values, are called **binary data**. Sets of binary data can
be summarized by the number of times and the percentage of cases in which an event has occurred.
the basis for computing the percentages in our case are 1000 life births. So in the case of
Norway in 1860 we can report the data by saying that among 1000 life births we had 102 
infant deaths in the first year of life. Expressed as a rate this would be $\frac{102}{1000}$, or
$0.102$, which amounts to $10.2$ percent.^[Remember from school mathematics that a percentage is a number or ratio expresses as a fraction of 100. It is often denoted by the
percentage sign %. A percentage is a dimensionless number. It has no unit of measurement. For
example 45 % is the fraction $\frac{45}{100}$ or 0.45. Percentages are often used to express
a proportionate part of the total. Thus when we see in the table that the mortality rate in
Germany in the year 1860 is 0.260 this is expressed in percent as mortality rate of 26 %.]

Each row in the table
is a *record* or sometimes also called an *observation*. Our table shown here has eight records. 
For doing statistics, especially when using the computer, it is often useful to display 
data tables such that each variable is a column and each record is a row.^[Such a format is
not always the reader friendliest to humans and thus data on the web are often 
organized differently. For example the Gapminder data show the Years as columns and countries
as rows. While easier to read such a table for working with the computer this deviation from
the format variable as column and observation as row, often creates problems. We will come back
to this seemingly minor but in fact quite important point over and over again. 
Hadley Wickham [@JSSv059i10], who
has contributed a lot to R and the R programming language which we will use in 
this course has popularized
the term "tidy" for the table format where every column is a variable and every row is an
observation.]

In this chapter we will use counts and proportions as the leading example to discuss the
basic presentation of statistics and data. We will learn about alternative ways to display data.
You will learn how design choices for the display of data help or prevent engagement and 
readability for your respective audience. You will also learn the 
first steps in R and how to use the computer to analyze and communicate data.

## Communicating Counts and Proportions

Let us follow the history of infant mortality around the globe. When we looked at the 1860ies
rates of infant mortality were very high, not much better than it had been all the centuries
before. 

But then about 100 years later we already see a significant reduction in the Western countries, 
with rates reduced still much further until now in the most affluent countries. Let us look at 
the country group for which we had data in 1860 already, again today in 2020,
before we go to the global picture. We will use this example to discuss some important aspects
of communication counts and proportions. Again we have ordered the observation by a decreasing
mortality rate.

```{r}
#| label: infant-mortality-2020
#| fig-cap: Infant mortality in some European countries in 2020.
#| warning: false

#read data from the data file our world in data

im_1960_2020 <- read.csv("data/infant_mortality/infant-mortality.csv")

names(im_1960_2020) <- c("Country", "Code", "Year", "Mortality Rate")

# Select variables to be consistent with previous format

im_1960_2020 <- im_1960_2020[c("Country", "Year", "Mortality Rate")]

# Select the country group used in the historical 1860 data

dat_sel <- im_1960_2020[im_1960_2020$Country %in% c("Germany", "Austria", "Netherlands", "Spain", "France", "Belgium", "Denmark", "Sweden", "Norway") & im_1960_2020$Year == 2020, ]

# In the data the mortality rate is given in percent. We add the corresponding counts

dat_sel$Count <- (dat_sel$"Mortality Rate"*10) 

# We transform the percentage rate to the actual rate of number of death per 1000 life births

dat_sel$"Mortality Rate" <- dat_sel$Count/1000

# reorder columns

dat_sel <- dat_sel[, c("Country", "Year", "Count", "Mortality Rate")]

# display the table and write text file of table

library(knitr)
kable(dat_sel[order(-dat_sel$"Mortality Rate"), ], digits = 4)
write.csv(dat_sel, file = "tables/table_2_2_infant_mortality_2020.csv", row.names = FALSE)

```

This is a spectacular improvement for this group of countries, who are
today all at about Within a bit more than a century the
mortality rate has been reduced from 30 % to below 0.3 % i.e. by a factor of about 100.
Isn't this a spectacular achievement?

As Vaclav Smil
has pointed out in a recent book [@Smil2020] such low rates are impossible without the combination
of a number of critical conditions, such as good healthcare in general, appropriate 
prenatal, perinatal and neonatal care, proper maternal and infant nutrition, adequate 
sanitary living conditions as well as access to social support for disadvantages families. All of
these factors require relevant government and private spending and on infrastructures that can be
universally used and accessed. Infant mortality is thus a very powerful 
indicator of quality of life in a country.

When data, such as counts and proportions are reported in a table we should make careful
considerations how the data are precisely presented. 

For instance in table about infant mortality in some Europen countries in 1860,
we could have reported the same information by
presenting survival rates instead of mortality rates. Such a choice in reporting is 
generally known as *framing*. Framing can have effects on the impact of communication. 
Depending on how you frame the communication of data, the same information might 
affect and engage your audience differently. Take for instance the data for Germany 1860. If we had
reported a survival rate of 74 % it might sound to many better than if we had reported the
equivalent information of a mortality rate of 26 %.

Risk impression can be made more clear if we report the actual counts as well as  
the percentages. The count or total number can then be imagined as an actual crowd of
people. 

A very interesting and illustrative example for this is given in the book by David Spiegelhalter[@Spi2019], which we have already encountered when we discussed the issue of
how many trees there are on the planet in the introduction. He describes
an advertisement in the London Underground, saying that 99 % of young Londoners 
do not commit serious violence. The add was presumably intended to reassure
passengers about the safety situation. Here is what he writes:

"...*we could reverse the emotional impact by two simple changes: First the statement means that 1 % of young Londoners do commit serious violence. Second, the population of London is around 9 million, there are around 1 million people aged between 15 and 25, and f we consider these as "young", this means there are 1 % of a million or a total of 10.00 seriously violent young people in the city. This does not sound at all reassuring. Note the two tricks used to manipulate the impact of this statistic: Convert from a positive to a negative frame, and then turn a percentage to an actual number of people.*"

A standard we should strive for when reporting data is providing impartial information. For this
we should thing carefully about our framing and should perhaps provide both positive and negative
frames. But even if we achieve this, we should consider other things, like the ordering
of the rows.

In this discussion the countries were presented in decreasing order of infant mortality rates. This
choice of display might create the impression that this was an important and valid way of 
comparing and ranking countries. While such rankings are popular in the media we should avoid such
displays of information. First of all the differences could be there just by chance. Furthermore
countries with low infant moralities usually have low population numbers smaller than 10 
million. They include the world's most homogeneous societies, like Japan, south Korea, 
Iceland, Finland and Norway. A country with a large and heterogeneous population, will 
find it difficult to achieve the same infant mortality rate as a small and homogenous country. 

## Visualizing infant mortality rates: First steps in R

While a table might be the medium of choice for displaying data, it is often more powerful to c
convey information visually. To enable you to visualize the infant-mortality data, we now begin
with an introduction to the computer language we will use throughout this course: The R language.
So here we want to begin this journey. 

:::{.callout-caution collapse="true"}
## Seitwerk: A decision pending.
Since we begin here to introduce R for the first time, a decision on how R will be used in the
course would be helpful. We have in principle three options. Assuming that students have (1) only an R installation, (2) R and RStudio, (3) R with Jupyter Books or Jupyter Lab.
:::



<!-- ## Contents -->

<!-- Introduce binary variables, variables that can be imagined as yes-no questions and how they can be summarized as proportions. -->

<!-- 1. The importance of framing -->
<!-- 2. Relative and absolute risk -->
<!-- 3. How to think in expected frequencies can promote understanding and provide an appropriate sense of importance, what are odds rations, why we need to understand what they mean and why we should avoid them in communication. -->
<!-- All these concepts and discussions should be accompanied by data visualization and students will learn how to visualize the data on the computer. -->

<!-- ## Outcome -->

<!-- The outcome of learning from the introduction and this chapter, which together form unit 1, students should have an overview of -->

<!-- 1. The contents of the course -->
<!-- 2. Should have formed expectations that this course will actively involve them and require their hands on participation -->
<!-- 3. Know how to start and stop R (Python) and R studio (Jupyter notebooks) and have played with one or two meaningful visualizations right away. -->

<!-- The way to achieve this is to prepare a visualization code in an interactive notebook, which students need not understand in all details. But they can change details, for instance if the variables contain countries, they could change the code such that the data for their own country are shown and rerun the visualization code. -->

<!-- After this unit the students should feel familiar with proportions and their meaning and interpretation. -->
<!-- We will also have gathered data from an activity which will be used later in the course. -->